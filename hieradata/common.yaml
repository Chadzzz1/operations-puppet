## NOTE namespaced keys (i.e. with ::) will NOT be looked up here
## See also https://phabricator.wikimedia.org/T209265

# General variables that once would have been in realm.pp
cluster: misc
datacenters:
  - eqiad
  - codfw
  - esams
  - ulsfo
  - eqsin


# Main statsd instance
statsd: statsd.eqiad.wmnet:8125
statsd_exporter_port: 9125

# Debmonitor instance
debmonitor: debmonitor.discovery.wmnet

# List of all prometheus nodes (ops instance)
prometheus_all_nodes:
  - bast3004.wikimedia.org
  - bast4002.wikimedia.org
  - bast5001.wikimedia.org
  - prometheus1003.eqiad.wmnet
  - prometheus1004.eqiad.wmnet
  - prometheus2003.codfw.wmnet
  - prometheus2004.codfw.wmnet

# NOTE: Do *not* add new clusters *per site* anymore,
# the site name will automatically be appended now,
# and a different IP prefix will be used.
wikimedia_clusters:
  decommissioned:
    description: "Decommissioned servers"
    id: 1
    sites: {}
  lvs:
    description: "LVS loadbalancers"
    id: 2
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  puppet:
    description: "Puppetmasters"
    id: 3
    sites:
      eqiad: []
      codfw: []
  search:
    description: "Search"
    id: 4
    sites: {}
  mysql:
    description: "MySQL"
    id: 5
    sites:
      eqiad: []
      codfw: []
  etcd:
    description: "Etcd"
    id: 6
    sites:
      eqiad: []
      codfw: []
  kafka_main:
    description: "Kafka main cluster"
    id: 7
    sites:
      eqiad: []
      codfw: []
  misc:
    description: "Miscellaneous"
    id: 8
    sites:
      eqiad: []
      codfw: []
      esams: []
  kubernetes:
    description: "Kubernetes"
    id: 9
    sites:
      eqiad: []
      codfw: []
  appserver:
    description: "Application servers"
    id: 11
    sites:
      eqiad: []
      codfw: []
  api_appserver:
    description: "API application servers"
    id: 13
    sites:
      eqiad: []
      codfw: []
  cache_text:
    description: "Text caches"
    id: 20
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  cache_canary:
    description: "Canary caches"
    id: 21
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
  cache_upload:
    description: "Upload caches"
    id: 22
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  payments:
    description: "Fundraiser payments"
    id: 23
    sites: {}
  ssl:
    description: "SSL cluster"
    id: 26
    sites: {}
  swift:
    description: "Swift"
    id: 27
    sites:
      eqiad: []
      codfw: []
      esams: []
  labvirt:
    description: "Labs virt hosts"
    id: 29
    sites:
      eqiad: []
  labs:
    description: "Labs services"
    id: 30
    sites:
      eqiad: []
  jobrunner:
    description: "Jobrunners"
    id: 31
    sites:
      eqiad: []
      codfw: []
  analytics:
    description: "Analytics cluster"
    id: 32
    sites:
      eqiad: []
  memcached:
    description: "Memcached"
    id: 33
    sites:
      eqiad: []
      codfw: []
  fundraising:
    description: "Fundraising"
    id: 35
    sites:
      eqiad:
        - pay-lvs1001.frack.eqiad.wmnet
        - pay-lvs1002.frack.eqiad.wmnet
  ceph:           # Not used anymore
    description: "Ceph"
    id: 36
    sites: {}
  parsoid:
    description: "Parsoid"
    id: 37
    sites:
      eqiad: []
      codfw: []
  redis:
    description: "Redis"
    id: 39
    sites:
      eqiad: []
      codfw: []
  labsnfs:
    description: "Labs NFS cluster"
    id: 40
    sites:
      eqiad: []
      codfw: []
  elasticsearch:
    description: "Elasticsearch cluster"
    id: 42
    sites:
      eqiad: []
      codfw: []
  logstash:
    description: "Logstash cluster"
    id: 43
    sites:
      eqiad: []
      codfw: []
  restbase:
    description: "Restbase"
    id: 48
    sites:
      eqiad: []
      codfw: []
  wdqs:
    description: "Wikidata Query Service - Public cluster"
    id: 49
    sites:
      eqiad: []
      codfw: []
  maps:
    description: "Maps Cluster"
    id: 50
    sites:
      eqiad: []
      codfw: []
  ganeti:
    description: "Ganeti Virt cluster"
    id: 52
    sites:
      eqiad: []
      codfw: []
  scb:
    description: "Service Cluster B"
    id: 53
    sites:
      eqiad: []
      codfw: []
  aqs:
    description: "Analytics Query Service"
    id: 54
    sites:
      eqiad: []
  restbase_test:
    description: "Restbase test"
    id: 55
    sites:
      eqiad: []
      codfw: []
  relforge:
    description: "Elasticsearch relforge cluster"
    id: 56
    sites:
      eqiad: []
  labtestvirt:
    description: "Labtest virt hosts"
    id: 57
    sites:
      codfw: []
  labtest:
    description: "Labtest services"
    id: 58
    sites:
      codfw: []
  restbase_dev:
    description: "Services development test"
    id: 59
    sites:
      eqiad: []
  thumbor:
    description: "Thumbor"
    id: 61
    sites:
      codfw: []
      eqiad: []
  kafka_jumbo:
    description: "Kafka Jumbo Cluster"
    id: 62
    sites:
      eqiad: []
  druid_analytics:
    description: "Druid Analytics Cluster"
    id: 63
    sites:
      eqiad: []
  druid_public:
    description: "Druid Public Cluster"
    id: 64
    sites:
      eqiad: []
  ores:
    description: "ORES Cluster"
    id: 65
    sites:
      eqiad: []
      codfw: []
  wdqs-internal:
    description: "Wikidata Query Service - Internal cluster"
    id: 66
    sites:
      eqiad: []
      codfw: []
  wdqs-test:
    description: "Wikidata Query Service - Test cluster"
    id: 67
    sites:
      eqiad: []
  proton:
    description: "Proton PDF rendering service"
    id: 68
    sites:
      eqiad: []
      codfw: []
  dnsbox:
    description: "DNS and NTP Combo Infra Boxes"
    id: 69
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  spare:
    description: "Spare servers"
    id: 70
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  prometheus:
    description: "Prometheus servers"
    id: 71
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  graphite:
    description: "Graphite servers"
    id: 72
    sites:
      eqiad: []
      codfw: []
  bastion:
    description: "Bastion servers"
    id: 73
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  cache_ats:
    description: "Apache Traffic Server (ATS) servers"
    id: 74
    sites:
      eqiad: []
      codfw: []
      esams: []
      ulsfo: []
      eqsin: []
  alerting:
    description: "Icinga"
    id: 75
    sites:
      eqiad: []
      codfw: []
  ci:
    description: "Continuous Integration servers"
    id: 76
    sites:
      eqiad: []
      codfw: []
  management:
    description: "Management servers"
    id: 77
    sites:
      eqiad: []
      codfw: []
  wmcs:
    description: "WMCS servers"
    id: 79
    sites:
      eqiad: []
  webperf:
    description: "Web Performance servers"
    id: 80
    sites:
      eqiad: []
      codfw: []
  poolcounter:
    description: "Poolcounter servers"
    id: 81
    sites:
      eqiad: []
      codfw: []
  dumps:
    description: "Dumps servers"
    id: 82
    sites:
      eqiad: []
  syslog:
    description: "Syslog servers"
    id: 83
    sites:
      eqiad: []
      codfw: []
  druid_test_analytics:
    description: "Druid Analytics Test Cluster"
    id: 84
    sites:
      eqiad: []
  sessionstore:
    description: "Sessionstore cluster"
    id: 85
    sites:
      eqiad: []
      codfw: []
  cloudelastic:
    description: "Elasticsearch cloudelastic cluster"
    id: 86
    sites:
      eqiad: []
  acmechief:
    description: "acme-chief hosts"
    id: 87
    sites:
      eqiad: []
      codfw: []
  eventschemas:
    description: "Event platform schemas"
    id: 88
    sites:
      eqiad: []
      codfw: []

puppetmaster: "puppet"
puppet_ca_server: puppetmaster1001.eqiad.wmnet
puppet_ca_source: puppet:///files/puppet/ca.production.pem
manage_puppet_ca_file: true

statistics_servers:
  - stat1004.eqiad.wmnet
  - stat1005.eqiad.wmnet
  - stat1006.eqiad.wmnet
  - stat1007.eqiad.wmnet
  - notebook1003.eqiad.wmnet
  - notebook1004.eqiad.wmnet
  - labstore1006.wikimedia.org
  - labstore1007.wikimedia.org
labstore_servers:
  - labstore1006.wikimedia.org
  - labstore1007.wikimedia.org
scratch_active_server: cloudstore1009.wikimedia.org
secondary_nfs_servers:
  - cloudstore1008.wikimedia.org
  - cloudstore1009.wikimedia.org
dumps_nfs_clients:
  snapshots:
    - snapshot1005.eqiad.wmnet
    - snapshot1006.eqiad.wmnet
    - snapshot1007.eqiad.wmnet
    - snapshot1008.eqiad.wmnet
    - snapshot1009.eqiad.wmnet
dumps_datadir_mount_type: nfs
dumps_nfs_server: dumpsdata1001.eqiad.wmnet
dumps_cron_nfs_server: dumpsdata1002.eqiad.wmnet
dumps_managed_subdirs: []
dumps_misc_cronrunner: false

# Dumps distribution servers actively serving NFS traffic
dumps_dist_nfs_servers: [labstore1006.wikimedia.org, labstore1007.wikimedia.org]

# Dumps distribution server currently serving traffic over NFS to cloud vps instances
dumps_dist_active_vps: labstore1007.wikimedia.org
# Dumps distribution server currently serving web and rsync mirror traffic
# Also serves stat* hosts over nfs
dumps_dist_active_web: labstore1006.wikimedia.org

# Cloud Services <
#
# Cumin
labs_tld: "wmflabs"

# /> Cloud Services
#

# List of all zookeeper clusters in production.
zookeeper_clusters:
  main-eqiad:
    hosts:
      conf1004.eqiad.wmnet: '1104'
      conf1005.eqiad.wmnet: '1105'
      conf1006.eqiad.wmnet: '1106'

  main-codfw:
    hosts:
      conf2001.codfw.wmnet: '2001'
      conf2002.codfw.wmnet: '2002'
      conf2003.codfw.wmnet: '2003'

  # ZK cluster for Druid analytics-eqiad cluster (non public),
  # colocated on druid hosts.
  druid-analytics-eqiad:
    hosts:
      druid1001.eqiad.wmnet: '1001'
      druid1002.eqiad.wmnet: '1002'
      druid1003.eqiad.wmnet: '1003'

  # ZK cluster for Druid public-eqiad cluster, (for AQS, wikistats, etc.)
  # colocated on druid hosts.
  druid-public-eqiad:
    hosts:
      druid1004.eqiad.wmnet: '1004'
      druid1005.eqiad.wmnet: '1005'
      druid1006.eqiad.wmnet: '1006'

  # ZK cluster for Druid analytics-test-eqiad cluster (non public),
  # colocated on druid hosts. This is mainly used as testing
  # environment for the Hadoop Test cluster jobs.
  druid-analytics-test-eqiad:
    hosts:
      analytics1041.eqiad.wmnet: '1001'

  # ZK Cluster dedicated to the Hadoop cluster (and its satellite systems)
  analytics-eqiad:
    hosts:
      an-conf1001.eqiad.wmnet: '1001'
      an-conf1002.eqiad.wmnet: '1002'
      an-conf1003.eqiad.wmnet: '1003'

# Used to sync the setting between all Kafka clusters and clients.
kafka_message_max_bytes: 4194304

kafka_clusters:

  main-eqiad:
    zookeeper_cluster_name: main-eqiad
    brokers:
      kafka-main1001.eqiad.wmnet:
        id: 1001
        rack: A
      kafka-main1002.eqiad.wmnet:
        id: 1002
        rack: B
      kafka-main1003.eqiad.wmnet:
        id: 1003
        rack: C

  main-codfw:
    zookeeper_cluster_name: main-codfw
    brokers:
      kafka-main2001.codfw.wmnet:
        id: 2001
        rack: A
      kafka-main2002.codfw.wmnet:
        id: 2002
        rack: B
      kafka-main2003.codfw.wmnet:
        id: 2003
        rack: C

  # NOTE:  The 'rack' here is used by the confluent kafka module
  # to assign broker.rack for Kafka rack awareness.  We are actually setting
  # the row letter, not the full row-rack number, since each of these brokers
  # are in different racks anyway.  We do awareness at the row level.
  jumbo-eqiad:
    zookeeper_cluster_name: main-eqiad
    brokers:
      kafka-jumbo1001.eqiad.wmnet:
        id: 1001
        rack: A
      kafka-jumbo1002.eqiad.wmnet:
        id: 1002
        rack: A
      kafka-jumbo1003.eqiad.wmnet:
        id: 1003
        rack: B
      kafka-jumbo1004.eqiad.wmnet:
        id: 1004
        rack: C
      kafka-jumbo1005.eqiad.wmnet:
        id: 1005
        rack: C
      kafka-jumbo1006.eqiad.wmnet:
        id: 1006
        rack: D

  # Kafka clusters for logs, see also T206454
  logging-eqiad:
    zookeeper_cluster_name: main-eqiad
    brokers:
      logstash1010.eqiad.wmnet:
        id: 1004
        rack: A
      logstash1011.eqiad.wmnet:
        id: 1005
        rack: B
      logstash1012.eqiad.wmnet:
        id: 1006
        rack: D

  logging-codfw:
    zookeeper_cluster_name: main-codfw
    brokers:
      logstash2001.codfw.wmnet:
        id: 2001
        rack: A
      logstash2002.codfw.wmnet:
        id: 2002
        rack: C
      logstash2003.codfw.wmnet:
        id: 2003
        rack: D

# Hadoop base configuration is common to multiple profiles, and must be kept
# in sync. Instead of having it repated multiple times it is convenient to
# have a single place in hiera to check/modify.
hadoop_clusters:
  analytics-test-hadoop:
    zookeeper_cluster_name: analytics-eqiad
    resourcemanager_hosts:
      - analytics1028.eqiad.wmnet
      - analytics1029.eqiad.wmnet
    namenode_hosts:
      - analytics1028.eqiad.wmnet
      - analytics1029.eqiad.wmnet
    journalnode_hosts:
      - analytics1031.eqiad.wmnet
      - analytics1034.eqiad.wmnet
      - analytics1038.eqiad.wmnet
    # analytics* Dell R720s have mounts on disks sdb - sdm.
    # (sda is hardware raid on the 2 2.5 drives in the flex bays.)
    datanode_mounts:
      - /var/lib/hadoop/data/b
      - /var/lib/hadoop/data/c
      - /var/lib/hadoop/data/d
      - /var/lib/hadoop/data/e
      - /var/lib/hadoop/data/f
      - /var/lib/hadoop/data/g
      - /var/lib/hadoop/data/h
      - /var/lib/hadoop/data/i
      - /var/lib/hadoop/data/j
      - /var/lib/hadoop/data/k
      - /var/lib/hadoop/data/l
      - /var/lib/hadoop/data/m
    net_topology:
      analytics1028.eqiad.wmnet:  /eqiad/C/2
      analytics1029.eqiad.wmnet:  /eqiad/C/2
      analytics1031.eqiad.wmnet:  /eqiad/C/2
      analytics1033.eqiad.wmnet:  /eqiad/C/3
      analytics1034.eqiad.wmnet:  /eqiad/C/3
      analytics1035.eqiad.wmnet:  /eqiad/D/8
      analytics1036.eqiad.wmnet:  /eqiad/D/8
      analytics1037.eqiad.wmnet:  /eqiad/D/8
      analytics1038.eqiad.wmnet:  /eqiad/D/4
      analytics1040.eqiad.wmnet:  /eqiad/D/4

    datanode_volumes_failed_tolerated: 2
    mapreduce_reduce_shuffle_parallelcopies: 10
    mapreduce_task_io_sort_mb: 200
    mapreduce_task_io_sort_factor: 10

    mapreduce_map_memory_mb: 2048
    mapreduce_map_java_opts: '-Xmx1638m'  # 0.8 * 2G

    mapreduce_reduce_memory_mb: 4096         # 2 * 2G
    mapreduce_reduce_java_opts: '-Xmx3276m'  # 0.8 * 2 * 2G

    yarn_app_mapreduce_am_resource_mb: 4096          # 2 * 2G
    yarn_app_mapreduce_am_command_opts: '-Xmx3276m'  # 0.8 * 2 * 2G

    yarn_scheduler_minimum_allocation_mb: 0

    yarn_scheduler_maximum_allocation_mb: 53248
    yarn_scheduler_minimum_allocation_vcores:   0
    yarn_scheduler_maximum_allocation_vcores:   32
    yarn_resourcemanager_zk_timeout_ms: 20000

    yarn_resourcemanager_zk_state_store_parent_path: '/yarn-rmstore/analytics-test-hadoop'
    yarn_resourcemanager_max_completed_applications: 1000

    hdfs_site_extra_properties:
      dfs.cluster.administrators: 'hdfs analytics-admins,ops'
      dfs.block.access.token.enable: 'true'
      dfs.namenode.keytab.file: '/etc/security/keytabs/hadoop/hdfs.keytab'
      dfs.namenode.kerberos.principal: 'hdfs/_HOST@WIKIMEDIA'
      dfs.secondary.namenode.keytab.file: '/etc/security/keytabs/hadoop/hdfs.keytab'
      dfs.secondary.namenode.kerberos.principal: 'hdfs/_HOST@WIKIMEDIA'
      dfs.journalnode.keytab.file: '/etc/security/keytabs/hadoop/hdfs.keytab'
      dfs.journalnode.kerberos.principal: 'hdfs/_HOST@WIKIMEDIA'
      dfs.journalnode.kerberos.internal.spnego.principal: 'HTTP/_HOST@WIKIMEDIA'
      dfs.web.authentication.kerberos.keytab: '/etc/security/keytabs/hadoop/HTTP.keytab'
      dfs.web.authentication.kerberos.principal: 'HTTP/_HOST@WIKIMEDIA'
      dfs.datanode.keytab.file: '/etc/security/keytabs/hadoop/hdfs.keytab'
      dfs.datanode.kerberos.principal: 'hdfs/_HOST@WIKIMEDIA'
      dfs.encrypt.data.transfer: 'true'
      dfs.data.transfer.protection: 'privacy'
      # This is required to allow the datanode to start:
      # https://hadoop.apache.org/docs/r2.6.0/hadoop-project-dist/hadoop-common/SecureMode.html#Secure_DataNode
      dfs.http.policy: 'HTTPS_ONLY'
      dfs.encrypt.data.transfer.cipher.suites: 'AES/CTR/NoPadding'
      dfs.encrypt.data.transfer.cipher.key.bitlength: '128'

    mapred_site_extra_properties:
      mapreduce.ssl.enabled: true
      mapreduce.shuffle.ssl.enabled: true
      mapreduce.jobhistory.principal: 'mapred/_HOST@WIKIMEDIA'
      mapreduce.jobhistory.keytab: '/etc/security/keytabs/hadoop/mapred.keytab'

    yarn_site_extra_properties:
      yarn.resourcemanager.principal: 'yarn/_HOST@WIKIMEDIA'
      yarn.resourcemanager.keytab: '/etc/security/keytabs/hadoop/yarn.keytab'
      yarn.nodemanager.principal: 'yarn/_HOST@WIKIMEDIA'
      yarn.nodemanager.keytab: '/etc/security/keytabs/hadoop/yarn.keytab'
      yarn.nodemanager.container-executor.class: 'org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor'
      yarn.nodemanager.linux-container-executor.group: 'yarn'

    yarn_nodemanager_container_executor_config:
      yarn.nodemanager.linux-container-executor.group: 'yarn'
      min.user.id: '100'
      allowed.system.users: 'nobody,hive'
      banned.users: 'root,hdfs,yarn,mapred,bin'

    core_site_extra_properties:
      hadoop.ssl.enabled: true
      hadoop.ssl.enabled.protocols: 'TLSv1.2'
      hadoop.rpc.protection: 'privacy'
      hadoop.security.authentication: 'kerberos'
      # https://www.cloudera.com/documentation/enterprise/5-16-x/topics/cdh_sg_hiveserver2_security.html#concept_vxf_pgx_nm
      hadoop.proxyuser.hive.hosts: '*'
      hadoop.proxyuser.hive.groups: '*'
      hadoop.proxyuser.oozie.hosts: '*'
      hadoop.proxyuser.oozie.groups: '*'
      hadoop.proxyuser.presto.hosts: '*'
      hadoop.proxyuser.presto.groups: '*'

  analytics-hadoop:
    zookeeper_cluster_name: analytics-eqiad
    resourcemanager_hosts:
      - an-master1001.eqiad.wmnet
      - an-master1002.eqiad.wmnet
    namenode_hosts:
      - an-master1001.eqiad.wmnet
      - an-master1002.eqiad.wmnet
    journalnode_hosts:
      - analytics1052.eqiad.wmnet  # Row A3
      - an-worker1078.eqiad.wmnet  # Row A2
      - analytics1072.eqiad.wmnet  # ROW B2
      - an-worker1090.eqiad.wmnet  # Row C4
      - analytics1069.eqiad.wmnet  # Row D8
    # analytics* Dell R720s have mounts on disks sdb - sdm.
    # (sda is hardware raid on the 2 2.5 drives in the flex bays.)
    datanode_mounts:
      - /var/lib/hadoop/data/b
      - /var/lib/hadoop/data/c
      - /var/lib/hadoop/data/d
      - /var/lib/hadoop/data/e
      - /var/lib/hadoop/data/f
      - /var/lib/hadoop/data/g
      - /var/lib/hadoop/data/h
      - /var/lib/hadoop/data/i
      - /var/lib/hadoop/data/j
      - /var/lib/hadoop/data/k
      - /var/lib/hadoop/data/l
      - /var/lib/hadoop/data/m
    net_topology:
      an-master1001.eqiad.wmnet:  /eqiad/A/5
      an-master1002.eqiad.wmnet:  /eqiad/B/8

      analytics1058.eqiad.wmnet:  /eqiad/A/1
      an-worker1078.eqiad.wmnet:  /eqiad/A/2
      an-worker1079.eqiad.wmnet:  /eqiad/A/2
      an-worker1080.eqiad.wmnet:  /eqiad/A/4
      analytics1052.eqiad.wmnet:  /eqiad/A/3
      analytics1053.eqiad.wmnet:  /eqiad/A/3
      analytics1054.eqiad.wmnet:  /eqiad/A/3
      analytics1055.eqiad.wmnet:  /eqiad/A/3
      analytics1056.eqiad.wmnet:  /eqiad/A/3
      analytics1057.eqiad.wmnet:  /eqiad/A/3
      analytics1059.eqiad.wmnet:  /eqiad/A/3
      analytics1060.eqiad.wmnet:  /eqiad/A/3
      analytics1070.eqiad.wmnet:  /eqiad/A/4
      analytics1071.eqiad.wmnet:  /eqiad/A/5
      an-worker1081.eqiad.wmnet:  /eqiad/A/7
      an-worker1082.eqiad.wmnet:  /eqiad/A/7

      analytics1072.eqiad.wmnet:  /eqiad/B/2
      an-worker1083.eqiad.wmnet:  /eqiad/B/2
      an-worker1084.eqiad.wmnet:  /eqiad/B/2
      analytics1046.eqiad.wmnet:  /eqiad/B/3
      analytics1047.eqiad.wmnet:  /eqiad/B/3
      analytics1048.eqiad.wmnet:  /eqiad/B/3
      analytics1049.eqiad.wmnet:  /eqiad/B/3
      analytics1050.eqiad.wmnet:  /eqiad/B/3
      analytics1051.eqiad.wmnet:  /eqiad/B/3
      an-worker1085.eqiad.wmnet:  /eqiad/B/4
      analytics1073.eqiad.wmnet:  /eqiad/B/7
      an-worker1086.eqiad.wmnet:  /eqiad/B/7
      an-worker1087.eqiad.wmnet:  /eqiad/B/7
      analytics1061.eqiad.wmnet:  /eqiad/B/8
      analytics1062.eqiad.wmnet:  /eqiad/B/8
      analytics1062.eqiad.wmnet:  /eqiad/B/8
      analytics1063.eqiad.wmnet:  /eqiad/B/8

      analytics1064.eqiad.wmnet:  /eqiad/C/2
      analytics1065.eqiad.wmnet:  /eqiad/C/2
      analytics1066.eqiad.wmnet:  /eqiad/C/2
      analytics1074.eqiad.wmnet:  /eqiad/C/2
      an-worker1088.eqiad.wmnet:  /eqiad/C/2
      an-worker1089.eqiad.wmnet:  /eqiad/C/4
      an-worker1090.eqiad.wmnet:  /eqiad/C/4
      analytics1075.eqiad.wmnet:  /eqiad/C/7
      an-worker1091.eqiad.wmnet:  /eqiad/C/7

      analytics1042.eqiad.wmnet:  /eqiad/D/2
      analytics1043.eqiad.wmnet:  /eqiad/D/2
      analytics1044.eqiad.wmnet:  /eqiad/D/2
      analytics1045.eqiad.wmnet:  /eqiad/D/2
      analytics1067.eqiad.wmnet:  /eqiad/D/2
      analytics1068.eqiad.wmnet:  /eqiad/D/2
      analytics1076.eqiad.wmnet:  /eqiad/D/2
      an-worker1092.eqiad.wmnet:  /eqiad/D/2
      an-worker1093.eqiad.wmnet:  /eqiad/D/2
      analytics1077.eqiad.wmnet:  /eqiad/D/7
      an-worker1094.eqiad.wmnet:  /eqiad/D/7
      an-worker1095.eqiad.wmnet:  /eqiad/D/7
      analytics1069.eqiad.wmnet:  /eqiad/D/8

    # The datanode daemon by default begins the shutdown procedure as soon as
    # on volume/disk failure is registered. In our use case we want to keep the
    # datanode working in case of one/two (two is very unlikey on the same host)
    # disk failures.
    datanode_volumes_failed_tolerated: 2

    # https://community.hortonworks.com/articles/43839/scaling-the-hdfs-namenode-part-2.html
    # 20 * log2(Cluster Size)
    dfs_namenode_handler_count: 115

    mapreduce_reduce_shuffle_parallelcopies: 10
    mapreduce_task_io_sort_mb: 200
    mapreduce_task_io_sort_factor: 10

    # Configure memory based on these recommendations and then adjusted:
    # http://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.0.6.0/bk_installing_manually_book/content/rpm-chap1-11.html

    # These Map/Reduce and YARN ApplicationMaster master settings are
    # settable per job.
    # All worker nodes are currently Dell R720s with 64G of RAM and 24 cores
    # or R730dxs with 128G of RAM and 48 cores.

    # Choosing 2G for default application container size.
    # Map container size and JVM max heap size (-XmX)
    mapreduce_map_memory_mb: 2048
    mapreduce_map_java_opts: '-Xmx1638m'  # 0.8 * 2G

    # Reduce container size and JVM max heap size (-Xmx)
    mapreduce_reduce_memory_mb: 4096         # 2 * 2G
    mapreduce_reduce_java_opts: '-Xmx3276m'  # 0.8 * 2 * 2G

    # Yarn ApplicationMaster container size and  max heap size (-Xmx)
    yarn_app_mapreduce_am_resource_mb: 4096          # 2 * 2G
    yarn_app_mapreduce_am_command_opts: '-Xmx3276m'  # 0.8 * 2 * 2G

    # Save 12G for OS and other processes.
    # R720s will have 52G for YARN with room for 26 2G containers.
    # R730dxs will have 116G for YARN with room for 52 2G containers.
    # The value of profile::hadoop::common::yarn_nodemanager_resource_memory_mb is set in regex.yaml.

    # Setting minimum_allocations to 0 to allow Impala to submit small reservation requests.
    # TODO: do we need to set this anymore?  We don't use Impala.
    yarn_scheduler_minimum_allocation_mb: 0
    # Allow a job to request up to the smallest value of yarn_nodemanager_resource_memory_mb
    # in the cluster. The smallest value is 52G on the R720s (analytics1069 and below).
    yarn_scheduler_maximum_allocation_mb: 53248
    yarn_scheduler_minimum_allocation_vcores:   0
    yarn_scheduler_maximum_allocation_vcores:   32
    # Raised for T206943
    yarn_resourcemanager_zk_timeout_ms: 20000

    yarn_resourcemanager_zk_state_store_parent_path: '/yarn-rmstore/analytics-hadoop'

    mapred_site_extra_properties:
      mapreduce.ssl.enabled: true
      mapreduce.shuffle.ssl.enabled: true

    core_site_extra_properties:
      hadoop.ssl.enabled.protocols: 'TLSv1.2'
      # Allow presto-server to impersonate users.
      # This is what allows presto to access files as users running queries.
      hadoop.proxyuser.presto.hosts: '*'
      hadoop.proxyuser.presto.groups: '*'

deployment_server: deploy1001.eqiad.wmnet

install_server: install1002.wikimedia.org
install_server_failover: install2002.wikimedia.org

netmon_server: netmon1002.wikimedia.org
netmon_server_failover: netmon2001.wikimedia.org

releases_server: releases1001.eqiad.wmnet
releases_server_failover: releases2001.codfw.wmnet

phabricator_server: 'phab1001.eqiad.wmnet'
phabricator_server_failover: 'phab2001.codfw.wmnet'

kerberos_realm_name: WIKIMEDIA
kerberos_kadmin_server_primary: 'krb1001.eqiad.wmnet'
kerberos_kadmin_keytabs_repo: 'puppetmaster1001.eqiad.wmnet'
kerberos_kdc_servers:
    - 'krb1001.eqiad.wmnet'
    - 'krb2001.codfw.wmnet'

# Etcd client global configuration
etcd_client_srv_domain: "conftool.%{::site}.wmnet"
etcd_host: ''
etcd_port: ''

# Conftool global prefix (will be per-dc)
conftool_prefix: "/conftool/v1"


# Logging: logstash, udp2log
logstash_host: "logstash.svc.eqiad.wmnet"
logstash_syslog_port: 10514
logstash_gelf_port: 12201
# TCP json_lines input
logstash_json_lines_port: 11514
# UDP logback/json input
logstash_logback_port: 11514
udp2log_aggregator: "udplog:8420"

tcpircbot_host: 'icinga.wikimedia.org'
tcpircbot_port: 9200

# User for jenkins master-slave connections
jenkins_agent_username: 'jenkins-slave'

# HTTP proxy (can be used as an env variable)
http_proxy: "http://webproxy.%{::site}.wmnet:8080"

# This is the "live" authdns server set, which feeds into any other tooling
# that needs to operate on them (including themselves).  It includes redundant
# IP address information so that authdns tooling can operate in the face of
# recdns issues.
authdns_servers:
  'authdns1001.wikimedia.org': 208.80.154.134
  'authdns2001.wikimedia.org': 208.80.153.17
  'ganeti3003.esams.wmnet': 10.20.0.33
  'dns1001.wikimedia.org': 208.80.154.10
  'dns1002.wikimedia.org': 208.80.155.108
  'dns2001.wikimedia.org': 208.80.153.77
  'dns2002.wikimedia.org': 208.80.153.111
  'dns3001.wikimedia.org': 91.198.174.61
  'dns3002.wikimedia.org': 91.198.174.62
  'dns4001.wikimedia.org': 198.35.26.7
  'dns4002.wikimedia.org': 198.35.26.8
  'dns5001.wikimedia.org': 103.102.166.8
  'dns5002.wikimedia.org': 103.102.166.9

# .. and this is the set of public IPs they provide service on, which is
# consumed by both authdns servers and the icinga monitoring of them.
# XXX - probably a better way to do this without common.yaml, and some
# restructuring to do in general, all of which may fall out when monitoring is
# redone anyways...
authdns_addrs:
  ns0-v4:
    address: '208.80.154.238'
  ns1-v4:
    address: '208.80.153.231'
  ns2-v4:
    address: '91.198.174.239'

# acme-chief active host
acmechief_host: 'acmechief1001.eqiad.wmnet'

mail_smarthost:
- 'mx1001.wikimedia.org'
- 'mx2001.wikimedia.org'

wikimail_smarthost:
- 'wiki-mail-eqiad.wikimedia.org'
- 'wiki-mail-codfw.wikimedia.org'

# These are our servers - they all peer to each other and sync to upstream NTP
# pool servers.
ntp_peers:
    eqiad:
    - 'dns1001.wikimedia.org'
    - 'dns1002.wikimedia.org'
    codfw:
    - 'dns2001.wikimedia.org'
    - 'dns2002.wikimedia.org'
    esams:
    - 'dns3001.wikimedia.org'
    - 'dns3002.wikimedia.org'
    ulsfo:
    - 'dns4001.wikimedia.org'
    - 'dns4002.wikimedia.org'
    eqsin:
    - 'dns5001.wikimedia.org'
    - 'dns5002.wikimedia.org'

# specified in the private repo
#k8s_infrastructure_users:
#  client-infrastructure:
#    type: infrastructure-readwrite
#    token: dummydummy
#    id: 1
#  kubelet:
#    type: system:node
#    token: dummydummydummy
#    id: 2

# Url to use for reaching graphite
graphite_url: 'http://graphite-in.eqiad.wmnet'

cumin_masters:
- 10.64.32.25                 # cumin1001.eqiad.wmnet
- 2620:0:861:103:10:64:32:25  # cumin1001.eqiad.wmnet
- 10.192.48.16                # cumin2001.codfw.wmnet
- 2620:0:860:104:10:192:48:16 # cumin2001.codfw.wmnet

maintenance_hosts:
- 10.64.16.77                 # mwmaint1002.eqiad.wmnet
- 2620:0:861:102:10:64:16:77  # mwmaint1002.eqiad.wmnet
- 10.192.48.45                # mwmaint2001.codfw.wmnet
- 2620:0:860:104:10:192:48:45 # mwmaint2001.codfw.wmnet

bastion_hosts:
- 208.80.154.86                 # bast1002.wikimedia.org
- 2620:0:861:3:208:80:154:86    # bast1002.wikimedia.org
- 208.80.153.54                 # bast2002.wikimedia.org
- 2620:0:860:2:208:80:153:54    # bast2002.wikimedia.org
- 91.198.174.60                 # bast3004.wikimedia.org
- 2620:0:862:1:91:198:174:60    # bast3004.wikimedia.org
- 198.35.26.6                   # bast4002.wikimedia.org
- 2620:0:863:1:198:35:26:6      # bast4002.wikimedia.org
- 103.102.166.7                 # bast5001.wikimedia.org
- 2001:df2:e500:1:103:102:166:7 # bast5001.wikimedia.org

cache_hosts:
- 10.64.0.130                    # cp1075.eqiad.wmnet
- 2620:0:861:101:10:64:0:130     # cp1075.eqiad.wmnet
- 10.64.0.131                    # cp1076.eqiad.wmnet
- 2620:0:861:101:10:64:0:131     # cp1076.eqiad.wmnet
- 10.64.0.132                    # cp1077.eqiad.wmnet
- 2620:0:861:101:10:64:0:132     # cp1077.eqiad.wmnet
- 10.64.0.133                    # cp1078.eqiad.wmnet
- 2620:0:861:101:10:64:0:133     # cp1078.eqiad.wmnet
- 10.64.16.22                    # cp1079.eqiad.wmnet
- 2620:0:861:102:10:64:16:22     # cp1079.eqiad.wmnet
- 10.64.16.23                    # cp1080.eqiad.wmnet
- 2620:0:861:102:10:64:16:23     # cp1080.eqiad.wmnet
- 10.64.16.24                    # cp1081.eqiad.wmnet
- 2620:0:861:102:10:64:16:24     # cp1081.eqiad.wmnet
- 10.64.16.25                    # cp1082.eqiad.wmnet
- 2620:0:861:102:10:64:16:25     # cp1082.eqiad.wmnet
- 10.64.32.67                    # cp1083.eqiad.wmnet
- 2620:0:861:103:10:64:32:67     # cp1083.eqiad.wmnet
- 10.64.32.68                    # cp1084.eqiad.wmnet
- 2620:0:861:103:10:64:32:68     # cp1084.eqiad.wmnet
- 10.64.32.69                    # cp1085.eqiad.wmnet
- 2620:0:861:103:10:64:32:69     # cp1085.eqiad.wmnet
- 10.64.32.70                    # cp1086.eqiad.wmnet
- 2620:0:861:103:10:64:32:70     # cp1086.eqiad.wmnet
- 10.64.48.101                   # cp1087.eqiad.wmnet
- 2620:0:861:107:10:64:48:101    # cp1087.eqiad.wmnet
- 10.64.48.102                   # cp1088.eqiad.wmnet
- 2620:0:861:107:10:64:48:102    # cp1088.eqiad.wmnet
- 10.64.48.103                   # cp1089.eqiad.wmnet
- 2620:0:861:107:10:64:48:103    # cp1089.eqiad.wmnet
- 10.64.48.104                   # cp1090.eqiad.wmnet
- 2620:0:861:107:10:64:48:104    # cp1090.eqiad.wmnet
- 10.192.0.122                   # cp2001.codfw.wmnet
- 2620:0:860:101:10:192:0:122    # cp2001.codfw.wmnet
- 10.192.0.123                   # cp2002.codfw.wmnet
- 2620:0:860:101:10:192:0:123    # cp2002.codfw.wmnet
- 10.192.0.124                   # cp2003.codfw.wmnet
- 2620:0:860:101:10:192:0:124    # cp2003.codfw.wmnet
- 10.192.0.125                   # cp2004.codfw.wmnet
- 2620:0:860:101:10:192:0:125    # cp2004.codfw.wmnet
- 10.192.0.126                   # cp2005.codfw.wmnet
- 2620:0:860:101:10:192:0:126    # cp2005.codfw.wmnet
- 10.192.0.127                   # cp2006.codfw.wmnet
- 2620:0:860:101:10:192:0:127    # cp2006.codfw.wmnet
- 10.192.16.133                  # cp2007.codfw.wmnet
- 2620:0:860:102:10:192:16:133   # cp2007.codfw.wmnet
- 10.192.16.134                  # cp2008.codfw.wmnet
- 2620:0:860:102:10:192:16:134   # cp2008.codfw.wmnet
- 10.192.16.135                  # cp2009.codfw.wmnet
- 2620:0:860:102:10:192:16:135   # cp2009.codfw.wmnet
- 10.192.16.136                  # cp2010.codfw.wmnet
- 2620:0:860:102:10:192:16:136   # cp2010.codfw.wmnet
- 10.192.16.137                  # cp2011.codfw.wmnet
- 2620:0:860:102:10:192:16:137   # cp2011.codfw.wmnet
- 10.192.16.138                  # cp2012.codfw.wmnet
- 2620:0:860:102:10:192:16:138   # cp2012.codfw.wmnet
- 10.192.32.112                  # cp2013.codfw.wmnet
- 2620:0:860:103:10:192:32:112   # cp2013.codfw.wmnet
- 10.192.32.113                  # cp2014.codfw.wmnet
- 2620:0:860:103:10:192:32:113   # cp2014.codfw.wmnet
- 10.192.32.114                  # cp2015.codfw.wmnet
- 2620:0:860:103:10:192:32:114   # cp2015.codfw.wmnet
- 10.192.32.115                  # cp2016.codfw.wmnet
- 2620:0:860:103:10:192:32:115   # cp2016.codfw.wmnet
- 10.192.32.116                  # cp2017.codfw.wmnet
- 2620:0:860:103:10:192:32:116   # cp2017.codfw.wmnet
- 10.192.32.117                  # cp2018.codfw.wmnet
- 2620:0:860:103:10:192:32:117   # cp2018.codfw.wmnet
- 10.192.48.23                   # cp2019.codfw.wmnet
- 2620:0:860:104:10:192:48:23    # cp2019.codfw.wmnet
- 10.192.48.24                   # cp2020.codfw.wmnet
- 2620:0:860:104:10:192:48:24    # cp2020.codfw.wmnet
- 10.192.48.25                   # cp2021.codfw.wmnet
- 2620:0:860:104:10:192:48:25    # cp2021.codfw.wmnet
- 10.192.48.26                   # cp2022.codfw.wmnet
- 2620:0:860:104:10:192:48:26    # cp2022.codfw.wmnet
- 10.192.48.27                   # cp2023.codfw.wmnet
- 2620:0:860:104:10:192:48:27    # cp2023.codfw.wmnet
- 10.192.48.28                   # cp2024.codfw.wmnet
- 2620:0:860:104:10:192:48:28    # cp2024.codfw.wmnet
- 10.192.48.29                   # cp2025.codfw.wmnet
- 2620:0:860:104:10:192:48:29    # cp2025.codfw.wmnet
- 10.192.48.30                   # cp2026.codfw.wmnet
- 2620:0:860:104:10:192:48:30    # cp2026.codfw.wmnet
- 10.20.0.50                     # cp3050.esams.wmnet
- 2620:0:862:102:10:20:0:50      # cp3050.esams.wmnet
- 10.20.0.51                     # cp3051.esams.wmnet
- 2620:0:862:102:10:20:0:51      # cp3051.esams.wmnet
- 10.20.0.52                     # cp3052.esams.wmnet
- 2620:0:862:102:10:20:0:52      # cp3052.esams.wmnet
- 10.20.0.53                     # cp3053.esams.wmnet
- 2620:0:862:102:10:20:0:53      # cp3053.esams.wmnet
- 10.20.0.54                     # cp3054.esams.wmnet
- 2620:0:862:102:10:20:0:54      # cp3054.esams.wmnet
- 10.20.0.55                     # cp3055.esams.wmnet
- 2620:0:862:102:10:20:0:55      # cp3055.esams.wmnet
- 10.20.0.56                     # cp3056.esams.wmnet
- 2620:0:862:102:10:20:0:56      # cp3056.esams.wmnet
- 10.20.0.57                     # cp3057.esams.wmnet
- 2620:0:862:102:10:20:0:57      # cp3057.esams.wmnet
- 10.20.0.58                     # cp3058.esams.wmnet
- 2620:0:862:102:10:20:0:58      # cp3058.esams.wmnet
- 10.20.0.59                     # cp3059.esams.wmnet
- 2620:0:862:102:10:20:0:59      # cp3059.esams.wmnet
- 10.20.0.60                     # cp3060.esams.wmnet
- 2620:0:862:102:10:20:0:60      # cp3060.esams.wmnet
- 10.20.0.61                     # cp3061.esams.wmnet
- 2620:0:862:102:10:20:0:61      # cp3061.esams.wmnet
- 10.20.0.62                     # cp3062.esams.wmnet
- 2620:0:862:102:10:20:0:62      # cp3062.esams.wmnet
- 10.20.0.63                     # cp3063.esams.wmnet
- 2620:0:862:102:10:20:0:63      # cp3063.esams.wmnet
- 10.20.0.64                     # cp3064.esams.wmnet
- 2620:0:862:102:10:20:0:64      # cp3064.esams.wmnet
- 10.20.0.65                     # cp3065.esams.wmnet
- 2620:0:862:102:10:20:0:65      # cp3065.esams.wmnet
- 10.128.0.121                   # cp4021.ulsfo.wmnet
- 2620:0:863:101:10:128:0:121    # cp4021.ulsfo.wmnet
- 10.128.0.122                   # cp4022.ulsfo.wmnet
- 2620:0:863:101:10:128:0:122    # cp4022.ulsfo.wmnet
- 10.128.0.123                   # cp4023.ulsfo.wmnet
- 2620:0:863:101:10:128:0:123    # cp4023.ulsfo.wmnet
- 10.128.0.124                   # cp4024.ulsfo.wmnet
- 2620:0:863:101:10:128:0:124    # cp4024.ulsfo.wmnet
- 10.128.0.125                   # cp4025.ulsfo.wmnet
- 2620:0:863:101:10:128:0:125    # cp4025.ulsfo.wmnet
- 10.128.0.126                   # cp4026.ulsfo.wmnet
- 2620:0:863:101:10:128:0:126    # cp4026.ulsfo.wmnet
- 10.128.0.127                   # cp4027.ulsfo.wmnet
- 2620:0:863:101:10:128:0:127    # cp4027.ulsfo.wmnet
- 10.128.0.128                   # cp4028.ulsfo.wmnet
- 2620:0:863:101:10:128:0:128    # cp4028.ulsfo.wmnet
- 10.128.0.129                   # cp4029.ulsfo.wmnet
- 2620:0:863:101:10:128:0:129    # cp4029.ulsfo.wmnet
- 10.128.0.130                   # cp4030.ulsfo.wmnet
- 2620:0:863:101:10:128:0:130    # cp4030.ulsfo.wmnet
- 10.128.0.131                   # cp4031.ulsfo.wmnet
- 2620:0:863:101:10:128:0:131    # cp4031.ulsfo.wmnet
- 10.128.0.132                   # cp4032.ulsfo.wmnet
- 2620:0:863:101:10:128:0:132    # cp4032.ulsfo.wmnet
- 10.132.0.101                   # cp5001.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:101 # cp5001.eqsin.wmnet
- 10.132.0.102                   # cp5002.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:102 # cp5002.eqsin.wmnet
- 10.132.0.103                   # cp5003.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:103 # cp5003.eqsin.wmnet
- 10.132.0.104                   # cp5004.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:104 # cp5004.eqsin.wmnet
- 10.132.0.105                   # cp5005.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:105 # cp5005.eqsin.wmnet
- 10.132.0.107                   # cp5007.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:107 # cp5007.eqsin.wmnet
- 10.132.0.108                   # cp5008.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:108 # cp5008.eqsin.wmnet
- 10.132.0.109                   # cp5009.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:109 # cp5009.eqsin.wmnet
- 10.132.0.110                   # cp5010.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:110 # cp5010.eqsin.wmnet
- 10.132.0.111                   # cp5011.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:111 # cp5011.eqsin.wmnet
- 10.132.0.112                   # cp5012.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:112 # cp5012.eqsin.wmnet
- 10.132.0.106                   # cp5006.eqsin.wmnet
- 2001:df2:e500:101:10:132:0:106 # cp5006.eqsin.wmnet

kafka_brokers_main:
- 10.64.0.200                  # kafka-main1001.eqiad.wmnet
- 2620:0:861:101:10:64:0:200   # kafka-main1001.eqiad.wmnet
- 10.64.16.37                  # kafka-main1002.eqiad.wmnet
- 2620:0:861:102:10:64:16:37   # kafka-main1002.eqiad.wmnet
- 10.64.32.90                  # kafka-main1003.eqiad.wmnet
- 2620:0:861:103:10:64:32:90   # kafka-main1003.eqiad.wmnet
- 10.192.0.17                  # kafka-main2001.codfw.wmnet
- 2620:0:860:101:10:192:0:17   # kafka-main2001.codfw.wmnet
- 10.192.16.8                  # kafka-main2002.codfw.wmnet
- 2620:0:860:102:10:192:16:8   # kafka-main2002.codfw.wmnet
- 10.192.32.136                # kafka-main2003.codfw.wmnet
- 2620:0:860:103:10:192:32:136 # kafka-main2003.codfw.wmnet
kafka_brokers_jumbo:
- 10.64.0.175                 # kafka-jumbo1001.eqiad.wmnet
- 2620:0:861:101:10:64:0:175  # kafka-jumbo1001.eqiad.wmnet
- 10.64.0.176                 # kafka-jumbo1002.eqiad.wmnet
- 2620:0:861:101:10:64:0:176  # kafka-jumbo1002.eqiad.wmnet
- 10.64.16.99                 # kafka-jumbo1003.eqiad.wmnet
- 2620:0:861:102:10:64:16:99  # kafka-jumbo1003.eqiad.wmnet
- 10.64.32.159                # kafka-jumbo1004.eqiad.wmnet
- 2620:0:861:103:10:64:32:159 # kafka-jumbo1004.eqiad.wmnet
- 10.64.32.160                # kafka-jumbo1005.eqiad.wmnet
- 2620:0:861:103:10:64:32:160 # kafka-jumbo1005.eqiad.wmnet
- 10.64.48.117                # kafka-jumbo1006.eqiad.wmnet
- 2620:0:861:107:10:64:48:117 # kafka-jumbo1006.eqiad.wmnet
kafka_brokers_logging:
- 10.64.0.181                  # logstash1010.eqiad.wmnet
- 2620:0:861:101:10:64:0:181   # logstash1010.eqiad.wmnet
- 10.64.16.30                  # logstash1011.eqiad.wmnet
- 2620:0:861:102:10:64:16:30   # logstash1011.eqiad.wmnet
- 10.64.48.177                 # logstash1012.eqiad.wmnet
- 2620:0:861:107:10:64:48:177  # logstash1012.eqiad.wmnet
- 10.192.0.112                 # logstash2001.codfw.wmnet
- 2620:0:860:101:10:192:0:112  # logstash2001.codfw.wmnet
- 10.192.32.180                # logstash2002.codfw.wmnet
- 2620:0:860:103:10:192:32:180 # logstash2002.codfw.wmnet
- 10.192.48.131                # logstash2003.codfw.wmnet
- 2620:0:860:104:10:192:48:131 # logstash2003.codfw.wmnet
zookeeper_hosts_main:
- 10.64.0.23                   # conf1004.eqiad.wmnet
- 2620:0:861:101:10:64:0:23    # conf1004.eqiad.wmnet
- 10.64.16.29                  # conf1005.eqiad.wmnet
- 2620:0:861:102:10:64:16:29   # conf1005.eqiad.wmnet
- 10.64.48.167                 # conf1006.eqiad.wmnet
- 2620:0:861:107:10:64:48:167  # conf1006.eqiad.wmnet
- 10.192.0.143                 # conf2001.codfw.wmnet
- 2620:0:860:101:10:192:0:143  # conf2001.codfw.wmnet
- 10.192.32.141                # conf2002.codfw.wmnet
- 2620:0:860:103:10:192:32:141 # conf2002.codfw.wmnet
- 10.192.48.52                 # conf2003.codfw.wmnet
- 2620:0:860:104:10:192:48:52  # conf2003.codfw.wmnet
druid_public_hosts:
- 10.64.0.35                  # druid1004.eqiad.wmnet
- 2620:0:861:101:10:64:0:35   # druid1004.eqiad.wmnet
- 10.64.16.172                # druid1005.eqiad.wmnet
- 2620:0:861:102:10:64:16:172 # druid1005.eqiad.wmnet
- 10.64.48.171                # druid1006.eqiad.wmnet
- 2620:0:861:107:10:64:48:171 # druid1006.eqiad.wmnet

mysql_root_clients:
# ipv6 interfaces are not yet allowed due to mysql grants
# do not put dns names or hostnames here, only ipv4
- 10.64.0.122  # db1115.eqiad.wmnet
- 10.192.48.91 # db2093.codfw.wmnet
- 10.64.32.25  # cumin1001.eqiad.wmnet
- 10.192.48.16 # cumin2001.codfw.wmnet

monitoring_hosts:
- 208.80.154.84              # icinga1001.wikimedia.org
- 2620:0:861:3:208:80:154:84 # icinga1001.wikimedia.org
- 208.80.153.74              # icinga2001.wikimedia.org
- 2620:0:860:3:208:80:153:74 # icinga2001.wikimedia.org

deployment_hosts:
- 10.64.32.16                 # deploy1001.eqiad.wmnet
- 2620:0:861:103:10:64:32:16  # deploy1001.eqiad.wmnet
- 10.192.32.24                # deploy2001.codfw.wmnet
- 2620:0:860:103:10:192:32:24 # deploy2001.codfw.wmnet

# shared certificates needed by acme-chief and other puppet modules like the ncredir one
# this is only required when a puppet module besides acme-chief needs access to certificate details
# like the list of SNIs
shared_acme_certificates:
  non-canonical-redirect-1:
    CN: 'wikipedia.com'
    SNI:
    - 'wikipedia.com'
    - '*.wikipedia.com'
    - '*.en-wp.com'
    - 'en-wp.com'
    - '*.en-wp.org'
    - 'en-wp.org'
    - '*.mediawiki.com'
    - 'mediawiki.com'
    - '*.voyagewiki.com'
    - 'voyagewiki.com'
    - '*.voyagewiki.org'
    - 'voyagewiki.org'
    - '*.wiikipedia.com'
    - 'wiikipedia.com'
    - '*.wikibook.com'
    - 'wikibook.com'
    - '*.wikibooks.com'
    - 'wikibooks.com'
    - '*.wikiepdia.com'
    - 'wikiepdia.com'
    - '*.wikiepdia.org'
    - 'wikiepdia.org'
    - '*.wikiipedia.org'
    - 'wikiipedia.org'
    - '*.wikijunior.com'
    - 'wikijunior.com'
    - '*.wikijunior.net'
    - 'wikijunior.net'
    - '*.wikijunior.org'
    - 'wikijunior.org'
    staging_time: 604800
    challenge: dns-01
    authorized_regexes:
    - '^ncredir100[12]\.eqiad\.wmnet$'
    - '^ncredir200[12]\.codfw\.wmnet$'
    prevalidate: true
    skip_invalid_snis: true
  non-canonical-redirect-2:
    CN: '*.wikimania.com'
    SNI:
    - '*.wikimania.com'
    - 'wikimania.com'
    - '*.wikimania.org'
    - 'wikimania.org'
    - '*.wikimedia.com'
    - 'wikimedia.com'
    - '*.wikimediacommons.co.uk'
    - 'wikimediacommons.co.uk'
    - '*.wikimediacommons.info'
    - 'wikimediacommons.info'
    - '*.wikimediacommons.jp.net'
    - 'wikimediacommons.jp.net'
    - '*.wikimediacommons.mobi'
    - 'wikimediacommons.mobi'
    - '*.wikimediacommons.net'
    - 'wikimediacommons.net'
    - '*.wikimediacommons.org'
    - 'wikimediacommons.org'
    - '*.wikimedia.community'
    - 'wikimedia.community'
    - '*.wikimania.asia'
    - 'wikimania.asia'
    - '*.wikimediafoundation.com'
    - 'wikimediafoundation.com'
    - '*.wikimediafoundation.info'
    - 'wikimediafoundation.info'
    - '*.wikimediafoundation.net'
    - 'wikimediafoundation.net'
    - '*.wikimedia.jp.net'
    - 'wikimedia.jp.net'
    - '*.wikimedia.lt'
    - 'wikimedia.lt'
    - '*.wikimedia.us'
    - 'wikimedia.us'
    - '*.wikinews.com'
    - 'wikinews.com'
    - '*.wikinews.de'
    - 'wikinews.de'
    staging_time: 604800
    challenge: dns-01
    authorized_regexes:
    - '^ncredir100[12]\.eqiad\.wmnet$'
    - '^ncredir200[12]\.codfw\.wmnet$'
    prevalidate: true
    skip_invalid_snis: true
  non-canonical-redirect-3:
    CN: '*.wikipedia.bg'
    SNI:
    - '*.wikipedia.bg'
    - 'wikipedia.bg'
    - '*.wikipedia.co.il'
    - 'wikipedia.co.il'
    - '*.wikipedia.co.za'
    - 'wikipedia.co.za'
    - '*.wikipedia.ee'
    - 'wikipedia.ee'
    - '*.wikipedia.gr'
    - 'wikipedia.gr'
    - '*.wikipedia.in'
    - 'wikipedia.in'
    - '*.wikipedia.info'
    - 'wikipedia.info'
    - '*.wikipedia.is'
    - 'wikipedia.is'
    - '*.wikipedia.lt'
    - 'wikipedia.lt'
    - '*.wikipedia.net'
    - 'wikipedia.net'
    - '*.wiki-pedia.org'
    - 'wiki-pedia.org'
    - '*.wikipedia.org.il'
    - 'wikipedia.org.il'
    - '*.wikipediazero.org'
    - 'wikipediazero.org'
    - '*.wikiquote.com'
    - 'wikiquote.com'
    - '*.wikiquote.net'
    - 'wikiquote.net'
    - '*.wikisource.com'
    - 'wikisource.com'
    - '*.wikisource.pl'
    - 'wikisource.pl'
    - '*.wikispecies.com'
    - 'wikispecies.com'
    staging_time: 604800
    challenge: dns-01
    authorized_regexes:
    - '^ncredir100[12]\.eqiad\.wmnet$'
    - '^ncredir200[12]\.codfw\.wmnet$'
    prevalidate: true
    skip_invalid_snis: true
  non-canonical-redirect-4:
    CN: '*.wikispecies.net'
    SNI:
    - '*.wikispecies.net'
    - 'wikispecies.net'
    - '*.wikispecies.org'
    - 'wikispecies.org'
    - '*.wikiversity.com'
    - 'wikiversity.com'
    - '*.wikivoyage.com'
    - 'wikivoyage.com'
    - '*.wikivoyage.de'
    - 'wikivoyage.de'
    - '*.wikivoyage.eu'
    - 'wikivoyage.eu'
    - '*.wikivoyage.net'
    - 'wikivoyage.net'
    - '*.wikivoyager.de'
    - 'wikivoyager.de'
    - '*.wikivoyager.org'
    - 'wikivoyager.org'
    - '*.wikpedia.org'
    - 'wikpedia.org'
    - '*.wiktionary.com'
    - 'wiktionary.com'
    - '*.wiktionary.eu'
    - 'wiktionary.eu'
    staging_time: 604800
    challenge: dns-01
    authorized_regexes:
    - '^ncredir100[12]\.eqiad\.wmnet$'
    - '^ncredir200[12]\.codfw\.wmnet$'
    prevalidate: true
    skip_invalid_snis: true
  non-canonical-redirect-5:
    CN: 'wikimedia.is'
    SNI:
    - 'wikimedia.is'
    - '*.wikimedia.is'
    - 'wikimedia.com.pt'
    - '*.wikimedia.com.pt'
    - 'indianwikimedia.com'
    - '*.indianwikimedia.com'
    - 'wikimedia.biz'
    - '*.wikimedia.biz'
    - 'wikimedia.xyz'
    - '*.wikimedia.xyz'
    - 'wwwwikimedia.com'
    - '*.wwwwikimedia.com'
    - 'wikipedia.es'
    - '*.wikipedia.es'
    - 'wkipedia.org'
    - '*.wkipedia.org'
    - 'wikkipedia.com'
    - '*.wikkipedia.com'
    - 'wilkipedia.org'
    - '*.wilkipedia.org'
    - 'wilipedia.com'
    - '*.wilipedia.com'
    - 'wikipediya.com'
    - '*.wikipediya.com'
    - 'wikipdia.org'
    - '*.wikipdia.org'
    - 'wikipedia.co.uk'
    - '*.wikipedia.co.uk'
    - 'wikipedia.uk'
    - '*.wikipedia.uk'
    - 'wikipedoa.org'
    - '*.wikipedoa.org'
    - 'wikipeedia.org'
    - '*.wikipeedia.org'
    - 'wiktionary.pl'
    - '*.wiktionary.pl'
    - 'wikipedia.com.ar'
    - '*.wikipedia.com.ar'
    - 'wikipedia.sk'
    - '*.wikipedia.sk'
    staging_time: 604800
    challenge: dns-01
    authorized_regexes:
    - '^ncredir100[12]\.eqiad\.wmnet$'
    - '^ncredir200[12]\.codfw\.wmnet$'
    prevalidate: true
    skip_invalid_snis: true
  non-canonical-redirect-6:
    CN: 'wikipedia.fi'
    SNI:
    - 'wikipedia.fi'
    - '*.wikipedia.fi'
    - 'wikisource.pt'
    - '*.wikisource.pt'
    - 'wiktionary.pt'
    - '*.wiktionary.pt'
    - 'wiki.voyage'
    - '*.wiki.voyage'
    - 'wikiversity.pt'
    - '*.wikiversity.pt'
    - 'wikiquote.pt'
    - '*.wikiquote.pt'
    - 'wikiquotes.info'
    - '*.wikiquotes.info'
    - 'wikinews.pt'
    - '*.wikinews.pt'
    - 'wikibooks.pt'
    - '*.wikibooks.pt'
    - 'wikipedia.id'
    - '*.wikipedia.id'
    - 'wikjpedia.org'
    - '*.wikjpedia.org'
    - 'wikipedial.org'
    - '*.wikipedial.org'
    - 'wikidata.es'
    - '*.wikidata.es'
    - 'wikidata.pt'
    - '*.wikidata.pt'
    - 'wikidata.us'
    - '*.wikidata.us'
    - 'wikipediafoundation.org'
    - '*.wikipediafoundation.org'
    - 'wikidpedia.org'
    - '*.wikidpedia.org'
    - 'wekipedia.com'
    - '*.wekipedia.com'
    - 'wikipaedia.net'
    - '*.wikipaedia.net'
    - 'wikepedia.org'
    - '*.wikepedia.org'
    staging_time: 604800
    challenge: dns-01
    authorized_regexes:
    - '^ncredir100[12]\.eqiad\.wmnet$'
    - '^ncredir200[12]\.codfw\.wmnet$'
    prevalidate: true
    skip_invalid_snis: true
ldap:
  base-dn: 'dc=wikimedia,dc=org'
  groups_cn: 'ou=groups'
  users_cn: 'ou=people'
apereo_cas:
  login_url: 'https://idp.wikimedia.org/login'
  validate_url: 'https://idp.wikimedia.org/serviceValidate'
