profile::openstack::eqiad1::neutron::base_interface: 'eno50'
profile::openstack::eqiad1::neutron::bind_port: 19696
profile::openstack::eqiad1::neutron::db_host: openstack.eqiad1.wikimediacloud.org
profile::openstack::eqiad1::neutron::network_flat_interface_vlan: '1105'
profile::openstack::eqiad1::neutron::network_flat_interface_vlan_external: '1120'
profile::openstack::eqiad1::neutron::rabbit_user: 'neutron'
profile::openstack::eqiad1::neutron::network_flat_name: 'cloudinstances2b'
# T193496
profile::openstack::eqiad1::neutron::network_public_ip: '185.15.56.1'
profile::openstack::eqiad1::neutron::dmz_cidr:
 # VMs --> wiki (text-lb.eqiad)
 - 172.16.0.0/21:208.80.154.224
 # VMs --> wiki (upload-lb.eqiad)
 - 172.16.0.0/21:208.80.154.240
 # VMs --> wiki (text-lb.codfw)
 - 172.16.0.0/21:208.80.153.224
 # VMs --> wiki (upload-lb.codfw)
 - 172.16.0.0/21:208.80.153.240
 # VMs --> wiki (text-lb.ulsfo)
 - 172.16.0.0/21:198.35.26.96
 # VMs --> wiki (upload-lb.ulsfo)
 - 172.16.0.0/21:198.35.26.112
 # VMs --> wiki (text-lb.eqsin)
 - 172.16.0.0/21:103.102.166.224
 # VMs --> wiki (upload-lb.eqsin)
 - 172.16.0.0/21:103.102.166.240
 # VMs --> wiki (text-lb.esams)
 - 172.16.0.0/21:91.198.174.192
 # VMs --> wiki (upload-lb.esams)
 - 172.16.0.0/21:91.198.174.208
 # VMs --> ns-recursor1.openstack.eqiad1.wikimediacloud.org
 - 172.16.0.0/21:208.80.154.24
 # VMs --> ns-recursor0.openstack.eqiad1.wikimediacloud.org
 - 172.16.0.0/21:208.80.154.143
 # VMs --> ns-recursor1.openstack.codfw1dev.wikimediacloud.org
 - 172.16.0.0/21:208.80.153.118
 # VMs --> ns-recursor0.openstack.codfw1dev.wikimediacloud.org
 - 172.16.0.0/21:208.80.153.78
 # VMs --> gerrit-replica.wikimedia.org
 - 172.16.0.0/21:208.80.153.107
 # VMs --> gerrit.wikimedia.org
 - 172.16.0.0/21:208.80.154.137
 # VMs --> apt1001.wikimedia.org
 - 172.16.0.0/21:208.80.154.30
 # VMs --> apt2001.wikimedia.org
 - 172.16.0.0/21:208.80.153.42
 # VMs --> sodium.wikimedia.org
 - 172.16.0.0/21:208.80.154.15
 # VMs --> cloudcontrol1003.wikimedia.org
 - 172.16.0.0/21:208.80.154.23
 # VMs --> cloudcontrol1004.wikimedia.org
 - 172.16.0.0/21:208.80.154.132
 # VMs --> cloudcontrol1005.wikimedia.org
 - 172.16.0.0/21:208.80.154.85
 # VMs --> cloudcontrol2001-dev.wikimedia.org
 - 172.16.0.0/21:208.80.153.59
 # VMs --> cloudcontrol2003-dev.wikimedia.org
 - 172.16.0.0/21:208.80.153.75
 # VMs --> cloudcontrol2004-dev.wikimedia.org
 - 172.16.0.0/21:208.80.153.116
 # VMs --> contint2001.wikimedia.org
 - 172.16.0.0/21:208.80.153.15
 # VMs --> kraz.wikimedia.org
 - 172.16.0.0/21:208.80.153.44
 # VMs --> ldap-ro.eqiad.wikimedia.org
 - 172.16.0.0/21:208.80.154.252
 # VMs --> ldap-ro.codfw.wikimedia.org
 - 172.16.0.0/21:208.80.153.252
 # VMs --> nfs-maps.wikimedia.org
 - 172.16.0.0/21:208.80.155.119
 # VMs --> labstore1007.wikimedia.org
 - 172.16.0.0/21:208.80.155.106
 # VMs --> labstore1006.wikimedia.org
 - 172.16.0.0/21:208.80.154.7
 # VMs --> cloudstore1009.wikimedia.org
 - 172.16.0.0/21:208.80.155.126
 # VMs --> cloudstore1008.wikimedia.org
 - 172.16.0.0/21:208.80.155.125
 # the following should match what's in homer/public.git cloud-in4 filter
 # there is no other access (NAT or not) to other 10.x.x.x services anyway
 # VMs --> nfs-tools-project.svc.eqiad.wmnet
 - 172.16.0.0/21:10.64.37.18/32
 # VMs --> wiki replicas (dbproxy1019 & dbproxy1018)
 - 172.16.0.0/21:10.64.37.28/32
 - 172.16.0.0/21:10.64.37.27/32
 # VMs --> cloudmetrics1001 / cloudmetrics1002
 - 172.16.0.0/21:10.64.37.13/32
 - 172.16.0.0/21:10.64.4.15/32
 # VMs --> relforge1001 / relforge1002
 - 172.16.0.0/21:10.64.4.13/32
 - 172.16.0.0/21:10.64.37.21/32
profile::openstack::eqiad1::neutron::l3_agent_bridges:
  br-external:
    addif: 'eno50.1120'
  br-internal:
    addif: 'eno50.1105'
profile::openstack::eqiad1::neutron::l3_agent_bridge_mappings:
  br-external: 'br-external'
  cloudinstances2b: 'br-internal'
profile::openstack::eqiad1::neutron::report_interval: '5'
profile::openstack::eqiad1::neutron::agent_down_time: '64'
profile::openstack::eqiad1::neutron::log_agent_heartbeats: 'True'

# Meet the conntrackd hack configuration. This should be included in upstream neutron-l3-agent
# instead... But for some reason the work hasn't been done. The values here are auto-generated by
# neutron, so they can change anytime, but hopefully, they don't change often enough, and this hack
# would just work. See T268335 for context.
profile::openstack::eqiad1::neutron::l3_conntrackd:
  cloudnet1003:
    netns: 'qrouter-d93771ba-2711-4f88-804a-8df6fd03978a'
    nic: 'ha-37a86ebc-17'
    local_addr: '169.254.192.9'
    remote_addr: '169.254.192.6'
    filter_ipv4:
      # don't sync ct info for the following local addresses
      - 169.254.0.1
      - 169.254.192.9
      - 169.254.192.6
      - 172.16.0.1
      - 185.15.56.10
  cloudnet1004:
    netns: 'qrouter-d93771ba-2711-4f88-804a-8df6fd03978a'
    nic: 'ha-d8c86248-12'
    local_addr: '169.254.192.6'
    remote_addr: '169.254.192.9'
    filter_ipv4:
      # don't sync ct info for the following local addresses
      - 169.254.0.1
      - 169.254.192.9
      - 169.254.192.6
      - 172.16.128.1
      - 185.15.56.10
