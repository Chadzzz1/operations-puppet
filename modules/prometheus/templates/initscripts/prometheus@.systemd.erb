[Unit]
Description=prometheus server (instance %i)

[Service]
User=prometheus
ExecStart=/usr/bin/prometheus --storage.tsdb.path <%= @metrics_path %> --web.listen-address <%= @listen_address %> --web.external-url <%= @external_url %> --storage.tsdb.retention <%= @storage_retention %> --config.file <%= @base_path %>/prometheus.yml --storage.tsdb.max-block-duration=24h --query.max-samples=10000000
Restart=on-failure
RestartSec=2s
TimeoutStopSec=10m
LimitNOFILE=32768
SyslogIdentifier=prometheus@%i
ExecReload=/bin/kill -HUP $MAINPID
