# SPDX-License-Identifier: Apache-2.0

profile::puppetmaster::pontoon::pki_enabled: true

# Needs overwrite
profile::pki::root_ca::db_driver: 'sqlite3'
profile::pki::root_ca::db_host: 'localhost'
profile::pki::root_ca::bootstrap: true

# Should be in common profile in hiera
profile::pki::root_ca::intermediates:
  - debmonitor
  - discovery
  - kafka
  - cloud_wmnet_ca
  - etcd

profile::pki::root_ca::common_name: 'Wikimedia_Internal_Root_CA'
# This is the vhost used for the ocsp/crl responder
profile::pki::root_ca::vhost: 'pki.discovery.wmnet'
profile::pki::root_ca::db_user: 'pki'
profile::pki::root_ca::db_name: 'pki'
profile::pki::root_ca::key_params:
   algo: ecdsa
   size: 521
profile::pki::root_ca::names:
  - organisation: Wikimedia Foundation, Inc
    organisational_unit: SRE Foundations
    locality: San Francisco
    state: California
    country: US
profile::pki::root_ca::profiles:
  intermediate:
    usages:
      - 'cert sign'
      - 'crl sign'
    ca_constraint:
      is_ca: true
      max_path_len: 1
    expiry: '43800h'
  ocsp:
    usages:
      - 'digital signature'
      - 'ocsp signing'
    expiry: '43800h'



# multiroot ca
profile::pki::client::signer_host: "%{alias('__master_for_role_pki__multirootca')}"
profile::pki::multirootca::maintenance_jobs: true
profile::pki::multirootca::db_driver: 'sqlite3'
profile::pki::multirootca::db_host: 'localhost'
profile::pki::multirootca::private_cert_base: '/etc/pontoon/pki'
profile::pki::multirootca::public_cert_base: '/etc/pontoon/pki'
#profile::pki::server::vhost: 'pki.discovery.wmnet'
#profile::pki::multirootca::vhost: 'pki.discovery.wmnet'
#profile::pki::root_ca::vhost: 'pki.discovery.wmnet'
