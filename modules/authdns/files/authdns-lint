#!/bin/bash

# Simple wrapper while the legacy jessie-based CI is still
# running, to use the CI stuff that's now inside the repo itself.
# Requires both arguments (workingdir and testdir), which is how
# the releng jessie CI stuff invokes this.

set -e

WORKINGDIR=$1
TESTDIR=$2

die() { echo >&2 "E: $*"; exit 1; }

if [ -z "$WORKINGDIR" ]; then
    die "no template dir specified"
fi
if [ -z "$TESTDIR" ]; then
    die "no test dir specified"
fi
echo "Executing check-gdnsd.sh from $WORKINGDIR with $TESTDIR as output"
cd $WORKINGDIR
utils/check-gdnsd.sh $TESTDIR
