-- haproxy
CREATE USER 'haproxy'@'10.64.16.155';

-- designate, labservices1002

CREATE USER 'designate'@'10.64.16.155'
IDENTIFIED BY '<%= @designate_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate`.* TO 'designate'@'10.64.16.155';

-- designate, labservices1001

CREATE USER 'designate'@'10.64.16.155'
IDENTIFIED BY '<%= @designate_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate`.* TO 'designate'@'10.64.16.155';

-- designate_pool_manager, labservices1002

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate\_pool\_manager`.* TO 'designate'@'10.64.16.155';

-- designate_pool_manager, labservices1001

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate\_pool\_manager`.* TO 'designate'@'10.64.16.155';

-- backups to dbstore1001

CREATE USER 'root'@'10.64.16.155'
IDENTIFIED BY '<%= @root_pass %>';

GRANT ALL PRIVILEGES
ON *.* TO 'root'@'10.64.48.17';

-- parsoid testing database from ruthenium
CREATE USER 'testreduce'@'10.64.16.155'
IDENTIFIED BY '<%= @testreduce_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `testreduce`.* TO 'testreduce'@'10.64.16.155';
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `testreduce_0715`.* TO 'testreduce'@'10.64.16.155';
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `testreduce_vd`.* TO 'testreduce'@'10.64.16.155';

-- parsoid testing database from ruthenium
-- (command line access for ssastry)
CREATE USER 'ssastry'@'10.64.16.155'
IDENTIFIED BY '<%= @testreduce_cli_pass %>';
GRANT SELECT, INSERT, UPDATE, DELETE, ALTER
ON `testreduce_0715`.* TO 'ssastry'@'10.64.16.155';
GRANT SELECT, INSERT, UPDATE, DELETE, ALTER
ON `testreduce_vd`.* TO 'ssastry'@'10.64.16.155';


-- keystone --

CREATE USER 'keystone'@'%'
IDENTIFIED BY '<%= @keystone_pass %>';

GRANT ALL PRIVILEGES ON `keystone`.* TO 'keystone'@'%'

-- neutron --

CREATE USER 'neutron'@'%'
IDENTIFIED BY '<%= @keystone_pass %>';

GRANT ALL PRIVILEGES ON `neutron`.* TO 'neutron'@'%'


-- designate, labservices1002

CREATE USER 'designate'@'208.80.154.12'
IDENTIFIED BY '<%= @designate_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate`.* TO 'designate'@'208.80.154.12';

-- designate, labservices1001

CREATE USER 'designate'@'208.80.155.117'
IDENTIFIED BY '<%= @designate_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate`.* TO 'designate'@'208.80.155.117';

-- designate, cloudservices1003

CREATE USER 'designate'@'208.80.154.135'
IDENTIFIED BY '<%= @designate_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate`.* TO 'designate'@'208.80.154.135';

-- designate, cloudservices1004

CREATE USER 'designate'@'208.80.154.11'
IDENTIFIED BY '<%= @designate_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER,
      CREATE TEMPORARY TABLES
ON `designate`.* TO 'designate'@'208.80.154.11';

-- designate_pool_manager, labservices1002

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, CREATE TEMPORARY TABLES
    ON `designate\_pool\_manager`.* TO 'designate'@'208.80.154.12';

-- designate_pool_manager, labservices1001

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, CREATE TEMPORARY TABLES
    ON `designate\_pool\_manager`.* TO 'designate'@'208.80.155.117';

-- designate_pool_manager, cloudservices1003

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, CREATE TEMPORARY TABLES
    ON `designate\_pool\_manager`.* TO 'designate'@'208.80.154.135';

-- designate_pool_manager, cloudservices1004

GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, CREATE TEMPORARY TABLES
    ON `designate\_pool\_manager`.* TO 'designate'@'208.80.154.11';

-- backups to dbstore1001

CREATE USER 'root'@'10.64.48.17'
IDENTIFIED BY '<%= @root_pass %>';

GRANT ALL PRIVILEGES
ON *.* TO 'root'@'10.64.48.17';

-- parsoid testing database from ruthenium
CREATE USER 'testreduce'@'10.64.16.151' IDENTIFIED BY '<%= @testreduce_pass %>';
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, CREATE TEMPORARY TABLES
ON `testreduce`.* TO 'testreduce'@'10.64.16.151';
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, CREATE TEMPORARY TABLES
ON `testreduce_0715`.* TO 'testreduce'@'10.64.16.151';
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, CREATE TEMPORARY TABLES
ON `testreduce_vd`.* TO 'testreduce'@'10.64.16.151';

-- parsoid testing database from ruthenium (command line access for ssastry)
CREATE USER 'ssastry'@'10.64.16.151' IDENTIFIED BY '<%= @testreduce_cli_pass %>';
GRANT SELECT, INSERT, UPDATE, DELETE, ALTER, DROP
ON `testreduce_0715`.* TO 'ssastry'@'10.64.16.151';
GRANT SELECT, INSERT, UPDATE, DELETE, ALTER, DROP
ON `testreduce_vd`.* TO 'ssastry'@'10.64.16.151';

-- striker application user. Will connect to DB labweb1001 and labweb1002
GRANT SELECT, INSERT, UPDATE, DELETE ON striker.* TO 'striker'@'208.80.154.160'
IDENTIFIED BY '<%= @striker_pass %>';
GRANT SELECT, INSERT, UPDATE, DELETE ON striker.* TO 'striker'@'208.80.155.109'
IDENTIFIED BY '<%= @striker_pass %>';

-- striker admin user. Will connect to DB from mwmaint1002/mwmaint2001, labweb1001 and labweb1002
GRANT ALL ON striker.* TO 'striker_admin'@'10.64.16.77'
IDENTIFIED BY '<%= @striker_admin_pass %>';
GRANT ALL ON striker.* TO 'striker_admin'@'10.192.48.45'
IDENTIFIED BY '<%= @striker_admin_pass %>';
GRANT ALL ON striker.* TO 'striker_admin'@'208.80.154.160'
IDENTIFIED BY '<%= @striker_admin_pass %>';
GRANT ALL ON striker.* TO 'striker_admin'@'208.80.155.109'
IDENTIFIED BY '<%= @striker_admin_pass %>';

-- wikiadmin user for wikitech aka 'labswiki' --
-- Will connect from labweb1001, labweb1002, mwmaint1002/mwmaint2001, deployment --

GRANT ALL ON `labswiki`.* TO 'wikiadmin'@'208.80.154.160'
IDENTIFIED BY '<%= @wikiadmin_pass %>';
GRANT ALL ON `labswiki`.* TO 'wikiadmin'@'208.80.155.109'
IDENTIFIED BY '<%= @wikiadmin_pass %>';

GRANT ALL ON `labswiki`.* TO 'wikiadmin'@'10.192.48.45'
IDENTIFIED BY '<%= @wikiadmin_pass %>';
GRANT ALL ON `labswiki`.* TO 'wikiadmin'@'10.64.16.77'
IDENTIFIED BY '<%= @wikiadmin_pass %>';

GRANT ALL ON `labswiki`.* TO 'wikiadmin'@'10.192.32.24'
IDENTIFIED BY '<%= @wikiadmin_pass %>';
GRANT ALL ON `labswiki`.* TO 'wikiadmin'@'10.64.0.196'
IDENTIFIED BY '<%= @wikiadmin_pass %>';
GRANT ALL ON `labswiki`.* TO 'wikiadmin'@'10.64.32.16'
IDENTIFIED BY '<%= @wikiadmin_pass %>';

-- wikiuser for wikitech aka 'labswiki' --
-- Will connect from labweb1001, labweb1002 --

GRANT DELETE, INSERT, SELECT, UPDATE ON `labswiki`.* TO 'wikiuser'@'208.80.154.160'
IDENTIFIED BY '<%= @wikiuser_pass %>';
GRANT DELETE, INSERT, SELECT, UPDATE ON `labswiki`.* TO 'wikiuser'@'208.80.155.109'
IDENTIFIED BY '<%= @wikiuser_pass %>';

-- wikiadmin user for labtestwikitech aka 'labtestwiki' --
-- Will connect from labtestweb2001, mwmaint1002/mwmaint2001, deployment --

GRANT ALL ON `labtestwiki`.* TO 'wikiadmin'@'208.80.153.14'
IDENTIFIED BY '<%= @wikiadmin_pass %>';

GRANT ALL ON `labtestwiki`.* TO 'wikiadmin'@'10.192.48.45'
IDENTIFIED BY '<%= @wikiadmin_pass %>';
GRANT ALL ON `labtestwiki`.* TO 'wikiadmin'@'10.64.16.77'
IDENTIFIED BY '<%= @wikiadmin_pass %>';

GRANT ALL ON `labtestwiki`.* TO 'wikiadmin'@'10.192.32.24'
IDENTIFIED BY '<%= @wikiadmin_pass %>';
GRANT ALL ON `labtestwiki`.* TO 'wikiadmin'@'10.64.0.196'
IDENTIFIED BY '<%= @wikiadmin_pass %>';
GRANT ALL ON `labtestwiki`.* TO 'wikiadmin'@'10.64.32.16'
IDENTIFIED BY '<%= @wikiadmin_pass %>';

-- wikiuser for labtestwikitech aka 'labtestwiki' --
-- Will connect from latestweb2001 --

GRANT DELETE, INSERT, SELECT, UPDATE ON `labtestwiki`.* TO 'wikiuser'@'208.80.153.14'
IDENTIFIED BY '<%= @wikiuser_pass %>';

-- labspuppetbackend user, will run on the labs puppetmaster host --

GRANT SELECT, INSERT, UPDATE, DELETE, ALTER
ON `labspuppet`.* TO 'labspuppet'@'208.80.154.92'
IDENTIFIED BY '<%= @labspuppet_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, ALTER
ON `labspuppet`.* TO 'labspuppet'@'208.80.154.158'
IDENTIFIED BY '<%= @labspuppet_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, ALTER
ON `labspuppet`.* TO 'labspuppet'@'208.80.155.120'
IDENTIFIED BY '<%= @labspuppet_pass %>';

GRANT SELECT, INSERT, UPDATE, DELETE, ALTER
ON `labspuppet`.* TO 'labspuppet'@'10.64.16.155'
IDENTIFIED BY '<%= @labspuppet_pass %>';

-- labsdbaccounts user, will run from labstore1004 and 1005

GRANT ALL ON labsdbaccounts.* TO 'labsdbaccounts'@'10.64.37.19'
IDENTIFIED BY '<%= @labsdbaccounts_pass %>';

GRANT ALL ON labsdbaccounts.* TO 'labsdbaccounts'@'10.64.37.20'
IDENTIFIED BY '<%= @labsdbaccounts_pass %>';

GRANT ALL ON labsdbaccounts.* TO 'labsdbaccounts'@'10.64.16.155'
IDENTIFIED BY '<%= @labsdbaccounts_pass %>';

-- Access to nova-eqiad1 and nova-api-eqiad1 from cloudcontrol1003.wikimedia.org and cloudcontrol1004.wikimedia.org
GRANT ALL PRIVILEGES ON nova_eqiad1.* TO 'nova'@'208.80.154.23' IDENTIFIED BY '<%= @nova_dbpass %>' WITH MAX_USER_CONNECTIONS 100;
GRANT ALL PRIVILEGES ON nova_api_eqiad1.* TO 'nova'@'208.80.154.23' IDENTIFIED BY '<%= @nova_dbpass %>' WITH MAX_USER_CONNECTIONS 100;
GRANT ALL PRIVILEGES ON nova_eqiad1.* TO 'nova'@'208.80.154.132' IDENTIFIED BY '<%= @nova_dbpass %>' WITH MAX_USER_CONNECTIONS 100;
GRANT ALL PRIVILEGES ON nova_api_eqiad1.* TO 'nova'@'208.80.154.132' IDENTIFIED BY '<%= @nova_dbpass %>' WITH MAX_USER_CONNECTIONS 100;
-- For legacy support, allow labcontrol1001 to access these as well
GRANT ALL PRIVILEGES ON nova_eqiad1.* TO 'nova'@'208.80.154.92' IDENTIFIED BY '<%= @nova_dbpass %>' WITH MAX_USER_CONNECTIONS 100;
GRANT ALL PRIVILEGES ON nova_api_eqiad1.* TO 'nova'@'208.80.154.92' IDENTIFIED BY '<%= @nova_dbpass %>' WITH MAX_USER_CONNECTIONS 100;
