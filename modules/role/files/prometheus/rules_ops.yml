# Generated by promtool v2.5.0 `promtool update rules rules_ops.conf`
groups:
- name: rules_ops.conf
  rules:
  - record: cluster_device:network_transmit_bytes:rate5m
    expr: sum by(cluster, device) (rate(node_network_transmit_bytes{job="node"}[5m]))
  - record: cluster_device:network_receive_bytes:rate5m
    expr: sum by(cluster, device) (rate(node_network_receive_bytes{job="node"}[5m]))
  - record: cluster_device:network_transmit_packets:rate5m
    expr: sum by(cluster, device) (rate(node_network_transmit_packets{job="node"}[5m]))
  - record: cluster_device:network_receive_packets:rate5m
    expr: sum by(cluster, device) (rate(node_network_receive_packets{job="node"}[5m]))
  - record: cluster_device:network_transmit_drop:rate5m
    expr: sum by(cluster, device) (rate(node_network_transmit_drop{job="node"}[5m]))
  - record: cluster_device:network_receive_drop:rate5m
    expr: sum by(cluster, device) (rate(node_network_receive_drop{job="node"}[5m]))
  - record: cluster_device:network_transmit_errs:rate5m
    expr: sum by(cluster, device) (rate(node_network_transmit_errs{job="node"}[5m]))
  - record: cluster_device:network_receive_errs:rate5m
    expr: sum by(cluster, device) (rate(node_network_receive_errs{job="node"}[5m]))
  - record: cluster:netstat_IpExt_InCsumErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_IpExt_InCsumErrors{job="node"}[5m]))
  - record: cluster:netstat_Ip_FragFails:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_FragFails{job="node"}[5m]))
  - record: cluster:netstat_Ip_InAddrErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_InAddrErrors{job="node"}[5m]))
  - record: cluster:netstat_Ip_InDiscards:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_InDiscards{job="node"}[5m]))
  - record: cluster:netstat_Ip_InHdrErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_InHdrErrors{job="node"}[5m]))
  - record: cluster:netstat_Ip_OutDiscards:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_OutDiscards{job="node"}[5m]))
  - record: cluster:netstat_Ip_OutNoRoutes:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_OutNoRoutes{job="node"}[5m]))
  - record: cluster:netstat_Ip_ReasmFails:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_ReasmFails{job="node"}[5m]))
  - record: cluster:netstat_Ip_ReasmTimeout:rate5m
    expr: sum by(cluster) (rate(node_netstat_Ip_ReasmTimeout{job="node"}[5m]))
  - record: cluster:netstat_Icmp_InMsgs:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_InMsgs{job="node"}[5m]))
  - record: cluster:netstat_Icmp_InEchos:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_InEchos{job="node"}[5m]))
  - record: cluster:netstat_Icmp_InCsumErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_InCsumErrors{job="node"}[5m]))
  - record: cluster:netstat_Icmp_InDestUnreachs:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_InDestUnreachs{job="node"}[5m]))
  - record: cluster:netstat_Icmp_InErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_InErrors{job="node"}[5m]))
  - record: cluster:netstat_Icmp_InTimeExcds:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_InTimeExcds{job="node"}[5m]))
  - record: cluster:netstat_Icmp_OutDestUnreachs:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_OutDestUnreachs{job="node"}[5m]))
  - record: cluster:netstat_Icmp_OutErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Icmp_OutErrors{job="node"}[5m]))
  - record: cluster:netstat_Tcp_ActiveOpens:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_ActiveOpens{job="node"}[5m]))
  - record: cluster:netstat_Tcp_AttemptFails:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_AttemptFails{job="node"}[5m]))
  - record: cluster:netstat_Tcp_CurrEstab:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_CurrEstab{job="node"}[5m]))
  - record: cluster:netstat_Tcp_EstabResets:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_EstabResets{job="node"}[5m]))
  - record: cluster:netstat_Tcp_InCsumErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_InCsumErrors{job="node"}[5m]))
  - record: cluster:netstat_Tcp_InErrs:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_InErrs{job="node"}[5m]))
  - record: cluster:netstat_Tcp_InSegs:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_InSegs{job="node"}[5m]))
  - record: cluster:netstat_Tcp_OutRsts:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_OutRsts{job="node"}[5m]))
  - record: cluster:netstat_Tcp_OutSegs:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_OutSegs{job="node"}[5m]))
  - record: cluster:netstat_Tcp_PassiveOpens:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_PassiveOpens{job="node"}[5m]))
  - record: cluster:netstat_Tcp_RetransSegs:rate5m
    expr: sum by(cluster) (rate(node_netstat_Tcp_RetransSegs{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_ListenDrops:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_ListenDrops{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_ListenOverflows:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_ListenOverflows{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_PruneCalled:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_PruneCalled{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_RcvPruned:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_RcvPruned{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_TCPAbortFailed:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPAbortFailed{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_TCPAbortOnData:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPAbortOnData{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_TCPAbortOnMemory:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPAbortOnMemory{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_TCPLossFailures:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPLossFailures{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_TCPLostRetransmit:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPLostRetransmit{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_TCPMemoryPressures:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPMemoryPressures{job="node"}[5m]))
  - record: cluster:netstat_TcpExt_TCPRetransFail:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPRetransFail{job="node"}[5m]))
  - record: cluster:netstat_Udp_InCsumErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Udp_InCsumErrors{job="node"}[5m]))
  - record: cluster:netstat_Udp_InDatagrams:rate5m
    expr: sum by(cluster) (rate(node_netstat_Udp_InDatagrams{job="node"}[5m]))
  - record: cluster:netstat_Udp_InErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Udp_InErrors{job="node"}[5m]))
  - record: cluster:netstat_Udp_NoPorts:rate5m
    expr: sum by(cluster) (rate(node_netstat_Udp_NoPorts{job="node"}[5m]))
  - record: cluster:netstat_Udp_OutDatagrams:rate5m
    expr: sum by(cluster) (rate(node_netstat_Udp_OutDatagrams{job="node"}[5m]))
  - record: cluster:netstat_Udp_RcvbufErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Udp_RcvbufErrors{job="node"}[5m]))
  - record: cluster:netstat_Udp_SndbufErrors:rate5m
    expr: sum by(cluster) (rate(node_netstat_Udp_SndbufErrors{job="node"}[5m]))
  - record: cluster:netstat_Tcp_Input_Errors:percent5m
    expr: sum by(cluster) (cluster:netstat_Tcp_InErrs:rate5m / cluster:netstat_Tcp_InSegs:rate5m)
  - record: cluster:netstat_Udp_Input_Errors:percent5m
    expr: sum by(cluster) (cluster:netstat_Udp_InErrors:rate5m / cluster:netstat_Udp_InDatagrams:rate5m)
  - record: cluster_device:network_receive_errors:percent5m
    expr: sum by(cluster, device) (cluster_device:network_receive_errs:rate5m / cluster_device:network_receive_packets:rate5m)
  - record: cluster_device:network_transmit_errors:percent5m
    expr: sum by(cluster, device) (cluster_device:network_transmit_errs:rate5m / cluster_device:network_transmit_packets:rate5m)
  - record: cluster:sockstat_FRAG_inuse:rate5m
    expr: sum by(cluster) (rate(node_sockstat_FRAG_inuse{job="node"}[5m]))
  - record: cluster:sockstat_RAW_inuse:rate5m
    expr: sum by(cluster) (rate(node_sockstat_RAW_inuse{job="node"}[5m]))
  - record: cluster:sockstat_TCP_alloc:rate5m
    expr: sum by(cluster) (rate(node_sockstat_TCP_alloc{job="node"}[5m]))
  - record: cluster:sockstat_TCP_inuse:rate5m
    expr: sum by(cluster) (rate(node_sockstat_TCP_inuse{job="node"}[5m]))
  - record: cluster:sockstat_TCP_orphan:rate5m
    expr: sum by(cluster) (rate(node_sockstat_TCP_orphan{job="node"}[5m]))
  - record: cluster:sockstat_TCP_tw:rate5m
    expr: sum by(cluster) (rate(node_sockstat_TCP_tw{job="node"}[5m]))
  - record: cluster:sockstat_UDP_inuse:rate5m
    expr: sum by(cluster) (rate(node_sockstat_UDP_inuse{job="node"}[5m]))
  - record: cluster:sockstat_sockets_used:rate5m
    expr: sum by(cluster) (rate(node_sockstat_sockets_used{job="node"}[5m]))
  - record: cluster_mode:cpu:rate5m
    expr: avg by(cluster, mode) (rate(node_cpu{job="node"}[5m]))
  - record: instance_mode:cpu:rate5m
    expr: avg by(instance, mode) (rate(node_cpu{job="node"}[5m]))
  - record: instance_cluster:node_cpu:count
    expr: count by(instance, cluster) (node_cpu{job="node",mode="idle"})
  - record: cluster:cpu:sum
    expr: sum by(cluster) (instance_cluster:node_cpu:count)
  - record: cluster:cpu_count:sum
    expr: cluster:cpu:sum
  - record: cluster_mountpoint:node_filesystem_size:sum
    expr: sum by(cluster, mountpoint) (node_filesystem_size{fstype!~"(tmpfs|rpc_pipefs)"})
  - record: cluster_mountpoint:node_filesystem_avail:sum
    expr: sum by(cluster, mountpoint) (node_filesystem_avail{fstype!~"(tmpfs|rpc_pipefs)"})
  - record: cluster_mountpoint:node_filesystem_free:sum
    expr: sum by(cluster, mountpoint) (node_filesystem_free{fstype!~"(tmpfs|rpc_pipefs)"})
  - record: cluster:memory_MemTotal:sum
    expr: sum by(cluster) (node_memory_MemTotal{job="node"})
  - record: cluster:memory_MemFree:sum
    expr: sum by(cluster) (node_memory_MemFree{job="node"})
  - record: cluster:memory_Buffers:sum
    expr: sum by(cluster) (node_memory_Buffers{job="node"})
  - record: cluster:memory_Cached:sum
    expr: sum by(cluster) (node_memory_Cached{job="node"})
  - record: cluster:memory_Writeback:sum
    expr: sum by(cluster) (node_memory_Writeback{job="node"})
  - record: cluster:memory_Dirty:sum
    expr: sum by(cluster) (node_memory_Dirty{job="node"})
  - record: cluster:memory_HardwareCorrupted:sum
    expr: sum by(cluster) (node_memory_HardwareCorrupted{job="node"})
  - record: cluster:memory_CommitLimit:sum
    expr: sum by(cluster) (node_memory_CommitLimit{job="node"})
  - record: cluster:memory_Committed_AS:sum
    expr: sum by(cluster) (node_memory_Committed_AS{job="node"})
  - record: cluster:memory_SwapTotal:sum
    expr: sum by(cluster) (node_memory_SwapTotal{job="node"})
  - record: cluster:memory_SwapFree:sum
    expr: sum by(cluster) (node_memory_SwapFree{job="node"})
  - record: cluster:memory_SwapUsed:sum
    expr: cluster:memory_SwapTotal:sum - cluster:memory_SwapFree:sum
  - record: cluster:memory_Used:sum
    expr: cluster:memory_MemTotal:sum - cluster:memory_Cached:sum - cluster:memory_Buffers:sum
      - cluster:memory_MemFree:sum
  - record: cluster:load1:sum
    expr: sum by(cluster) (node_load1{job="node"})
  - record: cluster:up:sum
    expr: sum by(cluster) (up{job="node"})
  - record: cluster:up:count
    expr: count by(cluster) (up{job="node"})
  - record: cluster:procs_running:sum
    expr: sum by(cluster) (node_procs_running{job="node"})
  - record: cluster:procs_blocked:sum
    expr: sum by(cluster) (node_procs_blocked{job="node"})
  - record: cluster:forks:rate5m
    expr: sum by(cluster) (rate(node_forks{job="node"}[5m]))
  - record: cluster:intr:rate5m
    expr: sum by(cluster) (rate(node_intr{job="node"}[5m]))
  - record: cluster:context_switches:rate5m
    expr: sum by(cluster) (rate(node_context_switches{job="node"}[5m]))
  - record: status_cc_xc:varnish_resourceloader_resp:irate5m
    expr: sum by(status, cache_control, x_cache) (irate(varnish_resourceloader_resp[5m]))
  - record: none:varnish_resourceloader_inm:irate5m
    expr: sum(irate(varnish_resourceloader_inm[5m]))
  - record: backend:varnish_backend_bereq_bodybytes:rate5m
    expr: sum without(server) (rate(varnish_backend_bereq_bodybytes[5m]))
  - record: backend:varnish_backend_bereq_hdrbytes:rate5m
    expr: sum without(server) (rate(varnish_backend_bereq_hdrbytes[5m]))
  - record: backend:varnish_backend_beresp_bodybytes:rate5m
    expr: sum without(server) (rate(varnish_backend_beresp_bodybytes[5m]))
  - record: backend:varnish_backend_beresp_hdrbytes:rate5m
    expr: sum without(server) (rate(varnish_backend_beresp_hdrbytes[5m]))
  - record: backend:varnish_backend_conn:rate5m
    expr: sum without(server) (rate(varnish_backend_conn[5m]))
  - record: backend:varnish_backend_happy:rate5m
    expr: sum without(server) (rate(varnish_backend_happy[5m]))
  - record: backend:varnish_backend_pipe_hdrbytes:rate5m
    expr: sum without(server) (rate(varnish_backend_pipe[5m]))
  - record: backend:varnish_backend_pipe_in:rate5m
    expr: sum without(server) (rate(varnish_backend_pipe_in[5m]))
  - record: backend:varnish_backend_pipe_out:rate5m
    expr: sum without(server) (rate(varnish_backend_pipe_out[5m]))
  - record: backend:varnish_backend_req:rate5m
    expr: sum without(server) (rate(varnish_backend_req[5m]))
  - record: instance_layer_job:varnish_main_uptime:resets5m
    expr: sum by(instance, layer, job) (resets(varnish_main_uptime[5m]))
  - record: auth_cipher_key_exchange_version:xcps_tls:sum
    expr: sum by(auth, cipher, key_exchange, version) (xcps_tls)
  - record: none:xcps_h2:sum
    expr: sum(xcps_h2)
  - record: none:xcps_tls_sess_reused:sum
    expr: sum(xcps_tls_sess_reused)
  - record: cluster_status:varnish_thumbnails:irate5m
    expr: sum by(cluster, status) (irate(varnish_thumbnails[5m]))
  - record: job_x_cache:varnish_x_cache:rate5m
    expr: sum without(instance) (rate(varnish_x_cache[5m]))
  - record: job_x_cache:varnish_x_cache:sum
    expr: sum without(instance) (varnish_x_cache)
  - record: job_method_status:varnish_requests:sum
    expr: sum by(job, method, status) (varnish_requests)
  - record: job_method_status:varnish_requests:rate5m
    expr: sum by(job, method, status) (rate(varnish_requests[5m]))
  - record: cluster_status:nginx_http_requests_total:sum
    expr: sum by(cluster, status) (nginx_http_requests_total)
  - record: cluster_status:nginx_http_requests_total:rate5m
    expr: sum by(cluster, status) (rate(nginx_http_requests_total[5m]))
  - record: job_method_status_backend:varnish_backend_requests_seconds_count:rate5m
    expr: sum by(job, method, status, backend) (rate(varnish_backend_requests_seconds_count[5m]))
  - record: instance_layer_job:varnish_backend_conn:sum
    expr: sum by(instance, layer, job) (varnish_backend_conn)
  - record: cluster_operation_result:trafficserver_cache_operations_total:rate5m
    expr: sum by(cluster, operation, result) (rate(trafficserver_cache_operations_total[5m]))
  - record: cluster_source:trafficserver_transactions_total:rate5m
    expr: sum by(cluster, source) (rate(trafficserver_transactions_total[5m]))
  - record: cluster_state:trafficserver_transaction_hits_total:rate5m
    expr: sum by(cluster, state) (rate(trafficserver_transaction_hits_total[5m]))
  - record: cluster_state:trafficserver_transaction_misses_total:rate5m
    expr: sum by(cluster, state) (rate(trafficserver_transaction_misses_total[5m]))
  - record: cluster_state:trafficserver_transaction_errors_total:rate5m
    expr: sum by(cluster, state) (rate(trafficserver_transaction_errors_total[5m]))
  - record: job_role_shard:mysql_global_status_queries:rate5m
    expr: sum by(job, role, shard) (rate(mysql_global_status_queries[5m]))
  - record: job_role_shard:mysql_global_status_handlers_write_total:rate5m
    expr: sum by(job, role, shard) (rate(mysql_global_status_handlers_total{handler=~"(write|update|delete).*"}[5m]))
  - record: job_role_shard:mysql_global_status_handlers_read_total:rate5m
    expr: sum by(job, role, shard) (rate(mysql_global_status_handlers_total{handler=~"read.*"}[5m]))
  - record: job_role_shard:mysql_global_status_bytes_received:rate5m
    expr: sum by(job, role, shard) (rate(mysql_global_status_bytes_received[5m]))
  - record: job_role_shard:mysql_global_status_bytes_sent:rate5m
    expr: sum by(job, role, shard) (rate(mysql_global_status_bytes_sent[5m]))
  - record: job_shard:mysql_slave_status_seconds_behind_master:max
    expr: max by(job, shard) (mysql_slave_status_seconds_behind_master)
  - record: command:memcached_commands_total:rate5m
    expr: sum by(command) (rate(memcached_commands_total[5m]))
  - record: command:memcached_items_evicted_total:rate5m
    expr: sum by(command) (rate(memcached_items_evicted_total[5m]))
  - record: command:memcached_items_reclaimed_total:rate5m
    expr: sum by(command) (rate(memcached_items_reclaimed_total[5m]))
  - record: none:memcached_read_bytes_total:rate5m
    expr: sum(rate(memcached_read_bytes_total[5m]))
  - record: none:memcached_written_bytes_total:rate5m
    expr: sum(rate(memcached_written_bytes_total[5m]))
  - record: instance_slab:memcached_slab_current_items:sum
    expr: sum by(instance, slab) (memcached_slab_current_items)
  - record: instance_slab:memcached_slab_current_chunks:sum
    expr: sum by(instance, slab) (memcached_slab_current_chunks)
  - record: cluster_state:apache_workers:sum
    expr: sum by(state, cluster) (apache_workers)
  - record: cluster_state:apache_scoreboard:sum
    expr: sum by(state, cluster) (apache_scoreboard)
  - record: cluster:apache_accesses_total
    expr: sum by(cluster) (apache_accesses_total)
  - record: cluster:apache_sent_kilobytes_total
    expr: sum by(cluster) (apache_sent_kilobytes_total)
  - record: cluster:hhvm_load:sum
    expr: sum by(cluster) (hhvm_load)
  - record: cluster:hhvm_queued:sum
    expr: sum by(cluster) (hhvm_queued)
  - record: cluster_segment:hhvm_process_memory_bytes:sum
    expr: sum by(cluster, segment) (hhvm_process_memory_bytes)
  - record: cluster_segment:hhvm_process_memory_bytes:avg
    expr: avg by(cluster, segment) (hhvm_process_memory_bytes)
  - record: instance_row:infeedPower:sum
    expr: sum by(instance, row) (infeedPower)
  - record: instance_row:infeedVoltage:max
    expr: max by(instance, row) (infeedVoltage)
  - record: instance_row:infeedVoltage:min
    expr: min by(instance, row) (infeedVoltage)
  - record: instance_row:infeedCapacityUsed:avg
    expr: avg by(instance, row) (infeedLoadValue / infeedCapacity)
  - record: instance_row:infeedLoadValue:max
    expr: max by(instance, row) (infeedLoadValue)
  - record: instance_row:infeedLoadValue:min
    expr: min by(instance, row) (infeedLoadValue)
  - record: instance:node_ipvs_backend_connections_active:rate5m
    expr: sum by(instance) (rate(node_ipvs_backend_connections_active[5m]))
  - record: local_port_local_address_instance:node_ipvs_backend_connections_active:rate5m
    expr: sum by(local_port, local_address, instance) (rate(node_ipvs_backend_connections_active[5m]))
  - record: local_port_local_address_instance:node_ipvs_backend_connections_inactive:rate5m
    expr: sum by(local_port, local_address, instance) (rate(node_ipvs_backend_connections_inactive[5m]))
  - record: cmd_job:redis_command_call_duration_seconds_count:rate5m
    expr: sum by(cmd, job) (rate(redis_command_call_duration_seconds_count[5m]))
  - record: cmd_job:redis_command_call_duration_seconds_sum:rate5m
    expr: sum by(cmd, job) (rate(redis_command_call_duration_seconds_sum[5m]))
  - record: cluster:rsyslog_queue_full:rate5m
    expr: sum by(cluster) (rate(rsyslog_queue_full[5m]))
  - record: cluster_input:rsyslog_input_submitted:rate5m
    expr: sum by(input, cluster) (rate(rsyslog_input_submitted[5m]))
  - record: cluster_action:rsyslog_action_processed:rate5m
    expr: sum by(action, cluster) (rate(rsyslog_action_processed[5m]))
  - record: cluster_action:rsyslog_action_failed:rate5m
    expr: sum by(action, cluster) (rate(rsyslog_action_failed[5m]))
  - record: cluster_action:rsyslog_action_suspended:rate5m
    expr: sum by(action, cluster) (rate(rsyslog_action_suspended[5m]))
  - record: cluster_queue:rsyslog_queue_discarded_full:rate5m
    expr: sum by(queue, cluster) (rate(rsyslog_queue_discarded_full[5m]))
  - record: cluster_queue:rsyslog_queue_discarded_not_full:rate5m
    expr: sum by(queue, cluster) (rate(rsyslog_queue_discarded_not_full[5m]))
  - record: cluster:node_netstat_TcpExt_TCPFastOpenActive:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPFastOpenActive[5m]))
  - record: cluster:node_netstat_TcpExt_TCPFastOpenActiveFail:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPFastOpenActiveFail[5m]))
  - record: cluster:node_netstat_TcpExt_TCPFastOpenCookieReqd:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPFastOpenCookieReqd[5m]))
  - record: cluster:node_netstat_TcpExt_TCPFastOpenListenOverflow:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPFastOpenListenOverflow[5m]))
  - record: cluster:node_netstat_TcpExt_TCPFastOpenPassive:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPFastOpenPassive[5m]))
  - record: cluster:node_netstat_TcpExt_TCPFastOpenPassiveFail:rate5m
    expr: sum by(cluster) (rate(node_netstat_TcpExt_TCPFastOpenPassiveFail[5m]))

# Most rules below are reversed from https://raw.githubusercontent.com/prometheus/node_exporter/v0.17.0/docs/example-16-compatibility-rules.yml
- name: node_exporter-16-bcache
  rules:
    - record: node_bcache_cache_read_races
      expr: node_bcache_cache_read_races_total
- name: node_exporter-16-buddyinfo
  rules:
    - record: node_buddyinfo_count
      expr: node_buddyinfo_blocks
- name: node_exporter-16-stat
  rules:
    - record: node_boot_time
      expr: node_boot_time_seconds
    - record: node_context_switches
      expr: node_context_switches_total
    - record: node_forks
      expr: node_forks_total
    - record: node_intr
      expr: node_intr_total
- name: node_exporter-16-cpu
  rules:
    - record: node_cpu
      expr: label_replace(node_cpu_seconds_total, "cpu", "cpu$1", "cpu", "(.+)")
    - record: node_cpu
      expr: label_replace(label_replace(label_replace(node_cpu_guest_seconds_total, "mode", "guest", "mode", "user"), "mode", "guest_nice", "mode", "nice"), "cpu", "cpu$1", "cpu", "(.+)")
- name: node_exporter-16-diskstats
  rules:
    - record: node_disk_bytes_read
      expr: node_disk_read_bytes_total
    - record: node_disk_bytes_written
      expr: node_disk_written_bytes_total
    - record: node_disk_io_time_ms
      expr: node_disk_io_time_seconds_total * 1000
    - record: node_disk_io_time_weighted
      expr: node_disk_io_time_weighted_seconds_total
    - record: node_disk_reads_completed
      expr: node_disk_reads_completed_total
    - record: node_disk_reads_merged
      expr: node_disk_reads_merged_total
    - record: node_disk_read_time_ms
      expr: node_disk_read_time_seconds_total * 1000
    - record: node_disk_writes_completed
      expr: node_disk_writes_completed_total
    - record: node_disk_writes_merged
      expr: node_disk_writes_merged_total
    - record: node_disk_write_time_ms
      expr: node_disk_write_time_seconds_total * 1000
- name: node_exporter-16-filesystem
  rules:
    - record: node_filesystem_free
      expr: node_filesystem_free_bytes
    - record: node_filesystem_avail
      expr: node_filesystem_avail_bytes
    - record: node_filesystem_size
      expr: node_filesystem_size_bytes
- name: node_exporter-16-infiniband
  rules:
    - record: node_infiniband_port_data_received_bytes
      expr: node_infiniband_port_data_received_bytes_total
    - record: node_infiniband_port_data_transmitted_bytes
      expr: node_infiniband_port_data_transmitted_bytes_total
- name: node_exporter-16-interrupts
  rules:
    - record: node_interrupts
      expr: node_interrupts_total
- name: node_exporter-16-memory
  rules:
    - record: node_memory_Active
      expr: node_memory_Active_bytes
    - record: node_memory_Active_anon
      expr: node_memory_Active_anon_bytes
    - record: node_memory_Active_file
      expr: node_memory_Active_file_bytes
    - record: node_memory_AnonHugePages
      expr: node_memory_AnonHugePages_bytes
    - record: node_memory_AnonPages
      expr: node_memory_AnonPages_bytes
    - record: node_memory_Bounce
      expr: node_memory_Bounce_bytes
    - record: node_memory_Buffers
      expr: node_memory_Buffers_bytes
    - record: node_memory_Cached
      expr: node_memory_Cached_bytes
    - record: node_memory_CommitLimit
      expr: node_memory_CommitLimit_bytes
    - record: node_memory_Committed_AS
      expr: node_memory_Committed_AS_bytes
    - record: node_memory_DirectMap2M
      expr: node_memory_DirectMap2M_bytes
    - record: node_memory_DirectMap4k
      expr: node_memory_DirectMap4k_bytes
    - record: node_memory_Dirty
      expr: node_memory_Dirty_bytes
    - record: node_memory_HardwareCorrupted
      expr: node_memory_HardwareCorrupted_bytes
    - record: node_memory_Hugepagesize
      expr: node_memory_Hugepagesize_bytes
    - record: node_memory_Inactive
      expr: node_memory_Inactive_bytes
    - record: node_memory_Inactive_anon
      expr: node_memory_Inactive_anon_bytes
    - record: node_memory_Inactive_file
      expr: node_memory_Inactive_file_bytes
    - record: node_memory_KernelStack
      expr: node_memory_KernelStack_bytes
    - record: node_memory_Mapped
      expr: node_memory_Mapped_bytes
    - record: node_memory_MemAvailable
      expr: node_memory_MemAvailable_bytes
    - record: node_memory_MemFree
      expr: node_memory_MemFree_bytes
    - record: node_memory_MemTotal
      expr: node_memory_MemTotal_bytes
    - record: node_memory_Mlocked
      expr: node_memory_Mlocked_bytes
    - record: node_memory_NFS_Unstable
      expr: node_memory_NFS_Unstable_bytes
    - record: node_memory_PageTables
      expr: node_memory_PageTables_bytes
    - record: node_memory_Shmem
      expr: node_memory_Shmem_bytes
    - record: node_memory_Slab
      expr: node_memory_Slab_bytes
    - record: node_memory_SReclaimable
      expr: node_memory_SReclaimable_bytes
    - record: node_memory_SUnreclaim
      expr: node_memory_SUnreclaim_bytes
    - record: node_memory_SwapCached
      expr: node_memory_SwapCached_bytes
    - record: node_memory_SwapFree
      expr: node_memory_SwapFree_bytes
    - record: node_memory_SwapTotal
      expr: node_memory_SwapTotal_bytes
    - record: node_memory_Unevictable
      expr: node_memory_Unevictable_bytes
    - record: node_memory_VmallocChunk
      expr: node_memory_VmallocChunk_bytes
    - record: node_memory_VmallocTotal
      expr: node_memory_VmallocTotal_bytes
    - record: node_memory_VmallocUsed
      expr: node_memory_VmallocUsed_bytes
    - record: node_memory_Writeback
      expr: node_memory_Writeback_bytes
    - record: node_memory_WritebackTmp
      expr: node_memory_WritebackTmp_bytes
    - record: node_memory_DirectMap1G
      expr: node_memory_DirectMap1G_bytes
- name: node_exporter-16-network
  rules:
    - record: node_network_receive_bytes
      expr: node_network_receive_bytes_total
    - record: node_network_receive_compressed
      expr: node_network_receive_compressed_total
    - record: node_network_receive_drop
      expr: node_network_receive_drop_total
    - record: node_network_receive_errs
      expr: node_network_receive_errs_total
    - record: node_network_receive_fifo
      expr: node_network_receive_fifo_total
    - record: node_network_receive_frame
      expr: node_network_receive_frame_total
    - record: node_network_receive_multicast
      expr: node_network_receive_multicast_total
    - record: node_network_receive_packets
      expr: node_network_receive_packets_total
    - record: node_network_transmit_bytes
      expr: node_network_transmit_bytes_total
    - record: node_network_transmit_compressed
      expr: node_network_transmit_compressed_total
    - record: node_network_transmit_drop
      expr: node_network_transmit_drop_total
    - record: node_network_transmit_errs
      expr: node_network_transmit_errs_total
    - record: node_network_transmit_fifo
      expr: node_network_transmit_fifo_total
    - record: node_network_transmit_frame
      expr: node_network_transmit_frame_total
    - record: node_network_transmit_multicast
      expr: node_network_transmit_multicast_total
    - record: node_network_transmit_packets
      expr: node_network_transmit_packets_total
- name: node_exporter-16-nfs
  rules:
    - record: node_nfs_net_connections
      expr: node_nfs_connections_total
    - record: node_nfs_net_reads
      expr: node_nfs_packets_total
    - record: node_nfs_procedures
      expr: label_replace(label_replace(node_nfs_requests_total, "procedure", "$1", "method", "(.+)"), "version", "$1", "proto", "(.+)")
    - record: node_nfs_rpc_authentication_refreshes
      expr: node_nfs_rpc_authentication_refreshes_total
    - record: node_nfs_rpc_operations
      expr: node_nfs_rpcs_total
    - record: node_nfs_rpc_retransmissions
      expr: node_nfs_rpc_retransmissions_total
- name: node_exporter-16-textfile
  rules:
    - record: node_textfile_mtime
      expr: node_textfile_mtime_seconds
